!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=a=t},e.toRadian=function(t){return t*i},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))};var r=e.EPSILON=1e-6,a=e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,i=(e.RANDOM=Math.random,Math.PI/180)},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=e[6],h=e[7],c=e[8],d=n[0],l=n[1],R=n[2],M=n[3],I=n[4],_=n[5],m=n[6],E=n[7],v=n[8];return t[0]=d*r+l*o+R*s,t[1]=d*a+l*f+R*h,t[2]=d*i+l*u+R*c,t[3]=M*r+I*o+_*s,t[4]=M*a+I*f+_*h,t[5]=M*i+I*u+_*c,t[6]=m*r+E*o+v*s,t[7]=m*a+E*f+v*h,t[8]=m*i+E*u+v*c,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,r,a,o,f,u,s){var h=new i.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=a,h[5]=o,h[6]=f,h[7]=u,h[8]=s,h},e.set=function(t,e,n,r,a,i,o,f,u,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=f,t[7]=u,t[8]=s,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],f=e[5],u=e[6],s=e[7],h=e[8],c=h*o-f*s,d=-h*i+f*u,l=s*i-o*u,R=n*c+r*d+a*l;return R?(R=1/R,t[0]=c*R,t[1]=(-h*r+a*s)*R,t[2]=(f*r-a*o)*R,t[3]=d*R,t[4]=(h*n-a*u)*R,t[5]=(-f*n+a*i)*R,t[6]=l*R,t[7]=(-s*n+r*u)*R,t[8]=(o*n-r*i)*R,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],f=e[5],u=e[6],s=e[7],h=e[8];return t[0]=o*h-f*s,t[1]=a*s-r*h,t[2]=r*f-a*o,t[3]=f*u-i*h,t[4]=n*h-a*u,t[5]=a*i-n*f,t[6]=i*s-o*u,t[7]=r*u-n*s,t[8]=n*o-r*i,t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],f=t[6],u=t[7],s=t[8];return e*(s*i-o*u)+n*(-s*a+o*f)+r*(u*a-i*f)},e.multiply=r,e.translate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=e[6],h=e[7],c=e[8],d=n[0],l=n[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=f,t[5]=u,t[6]=d*r+l*o+s,t[7]=d*a+l*f+h,t[8]=d*i+l*u+c,t},e.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=e[6],h=e[7],c=e[8],d=Math.sin(n),l=Math.cos(n);return t[0]=l*r+d*o,t[1]=l*a+d*f,t[2]=l*i+d*u,t[3]=l*o-d*r,t[4]=l*f-d*a,t[5]=l*u-d*i,t[6]=s,t[7]=h,t[8]=c,t},e.scale=function(t,e,n){var r=n[0],a=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,f=r+r,u=a+a,s=n*o,h=r*o,c=r*f,d=a*o,l=a*f,R=a*u,M=i*o,I=i*f,_=i*u;return t[0]=1-c-R,t[3]=h-_,t[6]=d+I,t[1]=h+_,t[4]=1-s-R,t[7]=l-M,t[2]=d-I,t[5]=l+M,t[8]=1-s-c,t},e.normalFromMat4=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],f=e[5],u=e[6],s=e[7],h=e[8],c=e[9],d=e[10],l=e[11],R=e[12],M=e[13],I=e[14],_=e[15],m=n*f-r*o,E=n*u-a*o,v=n*s-i*o,A=r*u-a*f,T=r*s-i*f,b=a*s-i*u,g=h*M-c*R,p=h*I-d*R,x=h*_-l*R,w=c*I-d*M,y=c*_-l*M,U=d*_-l*I,S=m*U-E*y+v*w+A*x-T*p+b*g;return S?(S=1/S,t[0]=(f*U-u*y+s*w)*S,t[1]=(u*x-o*U-s*p)*S,t[2]=(o*y-f*x+s*g)*S,t[3]=(a*y-r*U-i*w)*S,t[4]=(n*U-a*x+i*p)*S,t[5]=(r*x-n*y-i*g)*S,t[6]=(M*b-I*T+_*A)*S,t[7]=(I*v-R*b-_*E)*S,t[8]=(R*T-M*v+_*m)*S,t):null},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],o=t[3],f=t[4],u=t[5],s=t[6],h=t[7],c=t[8],d=e[0],l=e[1],R=e[2],M=e[3],I=e[4],_=e[5],m=e[6],E=e[7],v=e[8];return Math.abs(n-d)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-l)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(a-R)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-M)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(f-I)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(u-_)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(s-m)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(h-E)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(c-v)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(){var t=new R.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function a(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function i(t,e,n){var r=new R.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function f(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function u(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function s(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(n*n+r*r+a*a)}function h(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return n*n+r*r+a*a}function c(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function d(t,e){var n=e[0],r=e[1],a=e[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new R.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=a,e.fromValues=i,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=o,e.multiply=f,e.divide=u,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},e.distance=s,e.squaredDistance=h,e.squaredLength=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=d,e.dot=l,e.cross=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],f=n[1],u=n[2];return t[0]=a*u-i*f,t[1]=i*o-r*u,t[2]=r*f-a*o,t},e.lerp=function(t,e,n,r){var a=e[0],i=e[1],o=e[2];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t},e.hermite=function(t,e,n,r,a,i){var o=i*i,f=o*(2*i-3)+1,u=o*(i-2)+i,s=o*(i-1),h=o*(3-2*i);return t[0]=e[0]*f+n[0]*u+r[0]*s+a[0]*h,t[1]=e[1]*f+n[1]*u+r[1]*s+a[1]*h,t[2]=e[2]*f+n[2]*u+r[2]*s+a[2]*h,t},e.bezier=function(t,e,n,r,a,i){var o=1-i,f=o*o,u=i*i,s=f*o,h=3*i*f,c=3*u*o,d=u*i;return t[0]=e[0]*s+n[0]*h+r[0]*c+a[0]*d,t[1]=e[1]*s+n[1]*h+r[1]*c+a[1]*d,t[2]=e[2]*s+n[2]*h+r[2]*c+a[2]*d,t},e.random=function(t,e){e=e||1;var n=2*R.RANDOM()*Math.PI,r=2*R.RANDOM()-1,a=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=r*e,t},e.transformMat4=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[3]*r+n[7]*a+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/o,t[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/o,t[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/o,t},e.transformMat3=function(t,e,n){var r=e[0],a=e[1],i=e[2];return t[0]=r*n[0]+a*n[3]+i*n[6],t[1]=r*n[1]+a*n[4]+i*n[7],t[2]=r*n[2]+a*n[5]+i*n[8],t},e.transformQuat=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],f=n[1],u=n[2],s=n[3],h=s*r+f*i-u*a,c=s*a+u*r-o*i,d=s*i+o*a-f*r,l=-o*r-f*a-u*i;return t[0]=h*s+l*-o+c*-u-d*-f,t[1]=c*s+l*-f+d*-o-h*-u,t[2]=d*s+l*-u+h*-f-c*-o,t},e.rotateX=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},e.rotateY=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},e.rotateZ=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},e.angle=function(t,e){var n=i(t[0],t[1],t[2]),r=i(e[0],e[1],e[2]);d(n,n),d(r,r);var a=l(n,r);return a>1?0:a<-1?Math.PI:Math.acos(a)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],i=e[0],o=e[1],f=e[2];return Math.abs(n-i)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-f)<=R.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};var R=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.sub=o,e.mul=f,e.div=u,e.dist=s,e.sqrDist=h,e.len=a,e.sqrLen=c,e.forEach=function(){var t=r();return function(e,n,r,a,i,o){var f=void 0,u=void 0;for(n||(n=3),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,f=r;f<u;f+=n)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],i(t,t,o),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2];return e}}()},function(t,e,n){"use strict";function r(){var t=new l.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function i(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function o(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function f(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+a*a+i*i)}function s(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+a*a+i*i}function h(t){var e=t[0],n=t[1],r=t[2],a=t[3];return Math.sqrt(e*e+n*n+r*r+a*a)}function c(t){var e=t[0],n=t[1],r=t[2],a=t[3];return e*e+n*n+r*r+a*a}function d(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*n+r*r+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=r*o,t[2]=a*o,t[3]=i*o),t}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new l.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,r){var a=new l.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.multiply=i,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=f,e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.distance=u,e.squaredDistance=s,e.length=h,e.squaredLength=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=d,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],f=e[3];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t[3]=f+r*(n[3]-f),t},e.random=function(t,e){return e=e||1,t[0]=l.RANDOM(),t[1]=l.RANDOM(),t[2]=l.RANDOM(),t[3]=l.RANDOM(),d(t,t),f(t,t,e),t},e.transformMat4=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*a+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*a+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*a+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*a+n[11]*i+n[15]*o,t},e.transformQuat=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],f=n[1],u=n[2],s=n[3],h=s*r+f*i-u*a,c=s*a+u*r-o*i,d=s*i+o*a-f*r,l=-o*r-f*a-u*i;return t[0]=h*s+l*-o+c*-u-d*-f,t[1]=c*s+l*-f+d*-o-h*-u,t[2]=d*s+l*-u+h*-f-c*-o,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],i=t[3],o=e[0],f=e[1],u=e[2],s=e[3];return Math.abs(n-o)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-f)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-u)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-s)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.sub=a,e.mul=i,e.div=o,e.dist=u,e.sqrDist=s,e.len=h,e.sqrLen=c,e.forEach=function(){var t=r();return function(e,n,r,a,i,o){var f=void 0,u=void 0;for(n||(n=4),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,f=r;f<u;f+=n)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],t[3]=e[f+3],i(t,t,o),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2],e[f+3]=t[3];return e}}()},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var a=r(n(0)),i=r(n(5)),o=r(n(6)),f=r(n(1)),u=r(n(7)),s=r(n(8)),h=r(n(9)),c=r(n(2)),d=r(n(3));e.glMatrix=a,e.mat2=i,e.mat2d=o,e.mat3=f,e.mat4=u,e.quat=s,e.vec2=h,e.vec3=c,e.vec4=d},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=n[0],u=n[1],s=n[2],h=n[3];return t[0]=r*f+i*u,t[1]=a*f+o*u,t[2]=r*s+i*h,t[3]=a*s+o*h,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,r){var a=new i.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a},e.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},e.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*i-a*r;return o?(o=1/o,t[0]=i*o,t[1]=-r*o,t[2]=-a*o,t[3]=n*o,t):null},e.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=r,e.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*f,t[1]=a*u+o*f,t[2]=r*-f+i*u,t[3]=a*-f+o*u,t},e.scale=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=n[0],u=n[1];return t[0]=r*f,t[1]=a*f,t[2]=i*u,t[3]=o*u,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],o=t[3],f=e[0],u=e[1],s=e[2],h=e[3];return Math.abs(n-f)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-u)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-s)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(o-h)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=n[0],h=n[1],c=n[2],d=n[3],l=n[4],R=n[5];return t[0]=r*s+i*h,t[1]=a*s+o*h,t[2]=r*c+i*d,t[3]=a*c+o*d,t[4]=r*l+i*R+f,t[5]=a*l+o*R+u,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){var e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,r,a,o){var f=new i.ARRAY_TYPE(6);return f[0]=t,f[1]=e,f[2]=n,f[3]=r,f[4]=a,f[5]=o,f},e.set=function(t,e,n,r,a,i,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],f=e[5],u=n*i-r*a;return u?(u=1/u,t[0]=i*u,t[1]=-r*u,t[2]=-a*u,t[3]=n*u,t[4]=(a*f-i*o)*u,t[5]=(r*o-n*f)*u,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=r,e.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=Math.sin(n),h=Math.cos(n);return t[0]=r*h+i*s,t[1]=a*h+o*s,t[2]=r*-s+i*h,t[3]=a*-s+o*h,t[4]=f,t[5]=u,t},e.scale=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=n[0],h=n[1];return t[0]=r*s,t[1]=a*s,t[2]=i*h,t[3]=o*h,t[4]=f,t[5]=u,t},e.translate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=n[0],h=n[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=r*s+i*h+f,t[5]=a*s+o*h+u,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],o=t[3],f=t[4],u=t[5],s=e[0],h=e[1],c=e[2],d=e[3],l=e[4],R=e[5];return Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-h)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(a-c)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-d)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(f-l)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(l))&&Math.abs(u-R)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(R))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=e[4],u=e[5],s=e[6],h=e[7],c=e[8],d=e[9],l=e[10],R=e[11],M=e[12],I=e[13],_=e[14],m=e[15],E=n[0],v=n[1],A=n[2],T=n[3];return t[0]=E*r+v*f+A*c+T*M,t[1]=E*a+v*u+A*d+T*I,t[2]=E*i+v*s+A*l+T*_,t[3]=E*o+v*h+A*R+T*m,E=n[4],v=n[5],A=n[6],T=n[7],t[4]=E*r+v*f+A*c+T*M,t[5]=E*a+v*u+A*d+T*I,t[6]=E*i+v*s+A*l+T*_,t[7]=E*o+v*h+A*R+T*m,E=n[8],v=n[9],A=n[10],T=n[11],t[8]=E*r+v*f+A*c+T*M,t[9]=E*a+v*u+A*d+T*I,t[10]=E*i+v*s+A*l+T*_,t[11]=E*o+v*h+A*R+T*m,E=n[12],v=n[13],A=n[14],T=n[15],t[12]=E*r+v*f+A*c+T*M,t[13]=E*a+v*u+A*d+T*I,t[14]=E*i+v*s+A*l+T*_,t[15]=E*o+v*h+A*R+T*m,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,r,a,o,f,u,s,h,c,d,l,R,M,I){var _=new i.ARRAY_TYPE(16);return _[0]=t,_[1]=e,_[2]=n,_[3]=r,_[4]=a,_[5]=o,_[6]=f,_[7]=u,_[8]=s,_[9]=h,_[10]=c,_[11]=d,_[12]=l,_[13]=R,_[14]=M,_[15]=I,_},e.set=function(t,e,n,r,a,i,o,f,u,s,h,c,d,l,R,M,I){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=f,t[7]=u,t[8]=s,t[9]=h,t[10]=c,t[11]=d,t[12]=l,t[13]=R,t[14]=M,t[15]=I,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],i=e[6],o=e[7],f=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=f}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],f=e[5],u=e[6],s=e[7],h=e[8],c=e[9],d=e[10],l=e[11],R=e[12],M=e[13],I=e[14],_=e[15],m=n*f-r*o,E=n*u-a*o,v=n*s-i*o,A=r*u-a*f,T=r*s-i*f,b=a*s-i*u,g=h*M-c*R,p=h*I-d*R,x=h*_-l*R,w=c*I-d*M,y=c*_-l*M,U=d*_-l*I,S=m*U-E*y+v*w+A*x-T*p+b*g;return S?(S=1/S,t[0]=(f*U-u*y+s*w)*S,t[1]=(a*y-r*U-i*w)*S,t[2]=(M*b-I*T+_*A)*S,t[3]=(d*T-c*b-l*A)*S,t[4]=(u*x-o*U-s*p)*S,t[5]=(n*U-a*x+i*p)*S,t[6]=(I*v-R*b-_*E)*S,t[7]=(h*b-d*v+l*E)*S,t[8]=(o*y-f*x+s*g)*S,t[9]=(r*x-n*y-i*g)*S,t[10]=(R*T-M*v+_*m)*S,t[11]=(c*v-h*T-l*m)*S,t[12]=(f*p-o*w-u*g)*S,t[13]=(n*w-r*p+a*g)*S,t[14]=(M*E-R*A-I*m)*S,t[15]=(h*A-c*E+d*m)*S,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],f=e[5],u=e[6],s=e[7],h=e[8],c=e[9],d=e[10],l=e[11],R=e[12],M=e[13],I=e[14],_=e[15];return t[0]=f*(d*_-l*I)-c*(u*_-s*I)+M*(u*l-s*d),t[1]=-(r*(d*_-l*I)-c*(a*_-i*I)+M*(a*l-i*d)),t[2]=r*(u*_-s*I)-f*(a*_-i*I)+M*(a*s-i*u),t[3]=-(r*(u*l-s*d)-f*(a*l-i*d)+c*(a*s-i*u)),t[4]=-(o*(d*_-l*I)-h*(u*_-s*I)+R*(u*l-s*d)),t[5]=n*(d*_-l*I)-h*(a*_-i*I)+R*(a*l-i*d),t[6]=-(n*(u*_-s*I)-o*(a*_-i*I)+R*(a*s-i*u)),t[7]=n*(u*l-s*d)-o*(a*l-i*d)+h*(a*s-i*u),t[8]=o*(c*_-l*M)-h*(f*_-s*M)+R*(f*l-s*c),t[9]=-(n*(c*_-l*M)-h*(r*_-i*M)+R*(r*l-i*c)),t[10]=n*(f*_-s*M)-o*(r*_-i*M)+R*(r*s-i*f),t[11]=-(n*(f*l-s*c)-o*(r*l-i*c)+h*(r*s-i*f)),t[12]=-(o*(c*I-d*M)-h*(f*I-u*M)+R*(f*d-u*c)),t[13]=n*(c*I-d*M)-h*(r*I-a*M)+R*(r*d-a*c),t[14]=-(n*(f*I-u*M)-o*(r*I-a*M)+R*(r*u-a*f)),t[15]=n*(f*d-u*c)-o*(r*d-a*c)+h*(r*u-a*f),t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],f=t[6],u=t[7],s=t[8],h=t[9],c=t[10],d=t[11],l=t[12],R=t[13],M=t[14],I=t[15];return(e*o-n*i)*(c*I-d*M)-(e*f-r*i)*(h*I-d*R)+(e*u-a*i)*(h*M-c*R)+(n*f-r*o)*(s*I-d*l)-(n*u-a*o)*(s*M-c*l)+(r*u-a*f)*(s*R-h*l)},e.multiply=r,e.translate=function(t,e,n){var r=n[0],a=n[1],i=n[2],o=void 0,f=void 0,u=void 0,s=void 0,h=void 0,c=void 0,d=void 0,l=void 0,R=void 0,M=void 0,I=void 0,_=void 0;return e===t?(t[12]=e[0]*r+e[4]*a+e[8]*i+e[12],t[13]=e[1]*r+e[5]*a+e[9]*i+e[13],t[14]=e[2]*r+e[6]*a+e[10]*i+e[14],t[15]=e[3]*r+e[7]*a+e[11]*i+e[15]):(o=e[0],f=e[1],u=e[2],s=e[3],h=e[4],c=e[5],d=e[6],l=e[7],R=e[8],M=e[9],I=e[10],_=e[11],t[0]=o,t[1]=f,t[2]=u,t[3]=s,t[4]=h,t[5]=c,t[6]=d,t[7]=l,t[8]=R,t[9]=M,t[10]=I,t[11]=_,t[12]=o*r+h*a+R*i+e[12],t[13]=f*r+c*a+M*i+e[13],t[14]=u*r+d*a+I*i+e[14],t[15]=s*r+l*a+_*i+e[15]),t},e.scale=function(t,e,n){var r=n[0],a=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,r){var a=r[0],o=r[1],f=r[2],u=Math.sqrt(a*a+o*o+f*f),s=void 0,h=void 0,c=void 0,d=void 0,l=void 0,R=void 0,M=void 0,I=void 0,_=void 0,m=void 0,E=void 0,v=void 0,A=void 0,T=void 0,b=void 0,g=void 0,p=void 0,x=void 0,w=void 0,y=void 0,U=void 0,S=void 0,L=void 0,P=void 0;return Math.abs(u)<i.EPSILON?null:(u=1/u,a*=u,o*=u,f*=u,s=Math.sin(n),h=Math.cos(n),c=1-h,d=e[0],l=e[1],R=e[2],M=e[3],I=e[4],_=e[5],m=e[6],E=e[7],v=e[8],A=e[9],T=e[10],b=e[11],g=a*a*c+h,p=o*a*c+f*s,x=f*a*c-o*s,w=a*o*c-f*s,y=o*o*c+h,U=f*o*c+a*s,S=a*f*c+o*s,L=o*f*c-a*s,P=f*f*c+h,t[0]=d*g+I*p+v*x,t[1]=l*g+_*p+A*x,t[2]=R*g+m*p+T*x,t[3]=M*g+E*p+b*x,t[4]=d*w+I*y+v*U,t[5]=l*w+_*y+A*U,t[6]=R*w+m*y+T*U,t[7]=M*w+E*y+b*U,t[8]=d*S+I*L+v*P,t[9]=l*S+_*L+A*P,t[10]=R*S+m*L+T*P,t[11]=M*S+E*L+b*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[4],o=e[5],f=e[6],u=e[7],s=e[8],h=e[9],c=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+s*r,t[5]=o*a+h*r,t[6]=f*a+c*r,t[7]=u*a+d*r,t[8]=s*a-i*r,t[9]=h*a-o*r,t[10]=c*a-f*r,t[11]=d*a-u*r,t},e.rotateY=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],f=e[2],u=e[3],s=e[8],h=e[9],c=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-s*r,t[1]=o*a-h*r,t[2]=f*a-c*r,t[3]=u*a-d*r,t[8]=i*r+s*a,t[9]=o*r+h*a,t[10]=f*r+c*a,t[11]=u*r+d*a,t},e.rotateZ=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],f=e[2],u=e[3],s=e[4],h=e[5],c=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+s*r,t[1]=o*a+h*r,t[2]=f*a+c*r,t[3]=u*a+d*r,t[4]=s*a-i*r,t[5]=h*a-o*r,t[6]=c*a-f*r,t[7]=d*a-u*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){var r=n[0],a=n[1],o=n[2],f=Math.sqrt(r*r+a*a+o*o),u=void 0,s=void 0,h=void 0;return Math.abs(f)<i.EPSILON?null:(f=1/f,r*=f,a*=f,o*=f,u=Math.sin(e),s=Math.cos(e),h=1-s,t[0]=r*r*h+s,t[1]=a*r*h+o*u,t[2]=o*r*h-a*u,t[3]=0,t[4]=r*a*h-o*u,t[5]=a*a*h+s,t[6]=o*a*h+r*u,t[7]=0,t[8]=r*o*h+a*u,t[9]=a*o*h-r*u,t[10]=o*o*h+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=r+r,u=a+a,s=i+i,h=r*f,c=r*u,d=r*s,l=a*u,R=a*s,M=i*s,I=o*f,_=o*u,m=o*s;return t[0]=1-(l+M),t[1]=c+m,t[2]=d-_,t[3]=0,t[4]=c-m,t[5]=1-(h+M),t[6]=R+I,t[7]=0,t[8]=d+_,t[9]=R-I,t[10]=1-(h+l),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[4],o=e[5],f=e[6],u=e[8],s=e[9],h=e[10];return t[0]=Math.sqrt(n*n+r*r+a*a),t[1]=Math.sqrt(i*i+o*o+f*f),t[2]=Math.sqrt(u*u+s*s+h*h),t},e.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],f=e[3],u=a+a,s=i+i,h=o+o,c=a*u,d=a*s,l=a*h,R=i*s,M=i*h,I=o*h,_=f*u,m=f*s,E=f*h,v=r[0],A=r[1],T=r[2];return t[0]=(1-(R+I))*v,t[1]=(d+E)*v,t[2]=(l-m)*v,t[3]=0,t[4]=(d-E)*A,t[5]=(1-(c+I))*A,t[6]=(M+_)*A,t[7]=0,t[8]=(l+m)*T,t[9]=(M-_)*T,t[10]=(1-(c+R))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,r,a){var i=e[0],o=e[1],f=e[2],u=e[3],s=i+i,h=o+o,c=f+f,d=i*s,l=i*h,R=i*c,M=o*h,I=o*c,_=f*c,m=u*s,E=u*h,v=u*c,A=r[0],T=r[1],b=r[2],g=a[0],p=a[1],x=a[2];return t[0]=(1-(M+_))*A,t[1]=(l+v)*A,t[2]=(R-E)*A,t[3]=0,t[4]=(l-v)*T,t[5]=(1-(d+_))*T,t[6]=(I+m)*T,t[7]=0,t[8]=(R+E)*b,t[9]=(I-m)*b,t[10]=(1-(d+M))*b,t[11]=0,t[12]=n[0]+g-(t[0]*g+t[4]*p+t[8]*x),t[13]=n[1]+p-(t[1]*g+t[5]*p+t[9]*x),t[14]=n[2]+x-(t[2]*g+t[6]*p+t[10]*x),t[15]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,f=r+r,u=a+a,s=n*o,h=r*o,c=r*f,d=a*o,l=a*f,R=a*u,M=i*o,I=i*f,_=i*u;return t[0]=1-c-R,t[1]=h+_,t[2]=d-I,t[3]=0,t[4]=h-_,t[5]=1-s-R,t[6]=l+M,t[7]=0,t[8]=d+I,t[9]=l-M,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,r,a,i,o){var f=1/(n-e),u=1/(a-r),s=1/(i-o);return t[0]=2*i*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(n+e)*f,t[9]=(a+r)*u,t[10]=(o+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*s,t[15]=0,t},e.perspective=function(t,e,n,r,a){var i=1/Math.tan(e/2),o=1/(r-a);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*r*o,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),f=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+f),s=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(o-f)*u*.5,t[9]=(a-i)*s*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},e.ortho=function(t,e,n,r,a,i,o){var f=1/(e-n),u=1/(r-a),s=1/(i-o);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*f,t[13]=(a+r)*u,t[14]=(o+i)*s,t[15]=1,t},e.lookAt=function(t,e,n,r){var a=void 0,o=void 0,f=void 0,u=void 0,s=void 0,h=void 0,c=void 0,d=void 0,l=void 0,R=void 0,M=e[0],I=e[1],_=e[2],m=r[0],E=r[1],v=r[2],A=n[0],T=n[1],b=n[2];return Math.abs(M-A)<i.EPSILON&&Math.abs(I-T)<i.EPSILON&&Math.abs(_-b)<i.EPSILON?mat4.identity(t):(c=M-A,d=I-T,l=_-b,R=1/Math.sqrt(c*c+d*d+l*l),c*=R,d*=R,l*=R,a=E*l-v*d,o=v*c-m*l,f=m*d-E*c,(R=Math.sqrt(a*a+o*o+f*f))?(R=1/R,a*=R,o*=R,f*=R):(a=0,o=0,f=0),u=d*f-l*o,s=l*a-c*f,h=c*o-d*a,(R=Math.sqrt(u*u+s*s+h*h))?(R=1/R,u*=R,s*=R,h*=R):(u=0,s=0,h=0),t[0]=a,t[1]=u,t[2]=c,t[3]=0,t[4]=o,t[5]=s,t[6]=d,t[7]=0,t[8]=f,t[9]=h,t[10]=l,t[11]=0,t[12]=-(a*M+o*I+f*_),t[13]=-(u*M+s*I+h*_),t[14]=-(c*M+d*I+l*_),t[15]=1,t)},e.targetTo=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],f=r[0],u=r[1],s=r[2],h=a-n[0],c=i-n[1],d=o-n[2],l=h*h+c*c+d*d;l>0&&(l=1/Math.sqrt(l),h*=l,c*=l,d*=l);var R=u*d-s*c,M=s*h-f*d,I=f*c-u*h;return t[0]=R,t[1]=M,t[2]=I,t[3]=0,t[4]=c*I-d*M,t[5]=d*R-h*I,t[6]=h*M-c*R,t[7]=0,t[8]=h,t[9]=c,t[10]=d,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var n=t[0],r=t[1],a=t[2],o=t[3],f=t[4],u=t[5],s=t[6],h=t[7],c=t[8],d=t[9],l=t[10],R=t[11],M=t[12],I=t[13],_=t[14],m=t[15],E=e[0],v=e[1],A=e[2],T=e[3],b=e[4],g=e[5],p=e[6],x=e[7],w=e[8],y=e[9],U=e[10],S=e[11],L=e[12],P=e[13],D=e[14],N=e[15];return Math.abs(n-E)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(r-v)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(a-A)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(o-T)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(f-b)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(u-g)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(s-p)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(h-x)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(c-w)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(d-y)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(l-U)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(U))&&Math.abs(R-S)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(S))&&Math.abs(M-L)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(L))&&Math.abs(I-P)<=i.EPSILON*Math.max(1,Math.abs(I),Math.abs(P))&&Math.abs(_-D)<=i.EPSILON*Math.max(1,Math.abs(_),Math.abs(D))&&Math.abs(m-N)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(N))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.mul=r,e.sub=a},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(){var t=new s.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function i(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function o(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],f=n[0],u=n[1],s=n[2],h=n[3];return t[0]=r*h+o*f+a*s-i*u,t[1]=a*h+o*u+i*f-r*s,t[2]=i*h+o*s+r*u-a*f,t[3]=o*h-r*f-a*u-i*s,t}function f(t,e,n,r){var a=e[0],i=e[1],o=e[2],f=e[3],u=n[0],s=n[1],h=n[2],c=n[3],d=void 0,l=void 0,R=void 0,M=void 0,I=void 0;return(l=a*u+i*s+o*h+f*c)<0&&(l=-l,u=-u,s=-s,h=-h,c=-c),1-l>1e-6?(d=Math.acos(l),R=Math.sin(d),M=Math.sin((1-r)*d)/R,I=Math.sin(r*d)/R):(M=1-r,I=r),t[0]=M*a+I*u,t[1]=M*i+I*s,t[2]=M*o+I*h,t[3]=M*f+I*c,t}function u(t,e){var n=e[0]+e[4]+e[8],r=void 0;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+a]+e[3*a+i])*r,t[o]=(e[3*o+a]+e[3*a+o])*r}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=a,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=i,e.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},e.multiply=o,e.rotateX=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],f=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*f,t[1]=a*u+i*f,t[2]=i*u-a*f,t[3]=o*u-r*f,t},e.rotateY=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],f=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*f,t[1]=a*u+o*f,t[2]=i*u+r*f,t[3]=o*u-a*f,t},e.rotateZ=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],f=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*f,t[1]=a*u-r*f,t[2]=i*u+o*f,t[3]=o*u-i*f,t},e.calculateW=function(t,e){var n=e[0],r=e[1],a=e[2];return t[0]=n,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),t},e.slerp=f,e.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*n+r*r+a*a+i*i,f=o?1/o:0;return t[0]=-n*f,t[1]=-r*f,t[2]=-a*f,t[3]=i*f,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=u,e.fromEuler=function(t,e,n,r){var a=.5*Math.PI/180;e*=a,n*=a,r*=a;var i=Math.sin(e),o=Math.cos(e),f=Math.sin(n),u=Math.cos(n),s=Math.sin(r),h=Math.cos(r);return t[0]=i*u*h-o*f*s,t[1]=o*f*h+i*u*s,t[2]=o*u*s-i*f*h,t[3]=o*u*h+i*f*s,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var s=r(n(0)),h=r(n(1)),c=r(n(2)),d=r(n(3)),l=(e.clone=d.clone,e.fromValues=d.fromValues,e.copy=d.copy,e.set=d.set,e.add=d.add,e.mul=o,e.scale=d.scale,e.dot=d.dot,e.lerp=d.lerp,e.length=d.length),R=(e.len=l,e.squaredLength=d.squaredLength),M=(e.sqrLen=R,e.normalize=d.normalize);e.exactEquals=d.exactEquals,e.equals=d.equals,e.rotationTo=function(){var t=c.create(),e=c.fromValues(1,0,0),n=c.fromValues(0,1,0);return function(r,a,o){var f=c.dot(a,o);return f<-.999999?(c.cross(t,e,a),c.len(t)<1e-6&&c.cross(t,n,a),c.normalize(t,t),i(r,t,Math.PI),r):f>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(c.cross(t,a,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+f,M(r,r))}}(),e.sqlerp=function(){var t=a(),e=a();return function(n,r,a,i,o,u){return f(t,r,o,u),f(e,a,i,u),f(n,t,e,2*u*(1-u)),n}}(),e.setAxes=function(){var t=h.create();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],M(e,u(e,t))}}()},function(t,e,n){"use strict";function r(){var t=new c.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function i(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function o(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function f(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function s(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function h(t){var e=t[0],n=t[1];return e*e+n*n}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=r,e.clone=function(t){var e=new c.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var n=new c.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=a,e.multiply=i,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},e.distance=f,e.squaredDistance=u,e.length=s,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],r=e[1],a=n*n+r*r;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},e.lerp=function(t,e,n,r){var a=e[0],i=e[1];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t},e.random=function(t,e){e=e||1;var n=2*c.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a,t[1]=n[1]*r+n[3]*a,t},e.transformMat2d=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a+n[4],t[1]=n[1]*r+n[3]*a+n[5],t},e.transformMat3=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[3]*a+n[6],t[1]=n[1]*r+n[4]*a+n[7],t},e.transformMat4=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[4]*a+n[12],t[1]=n[1]*r+n[5]*a+n[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var n=t[0],r=t[1],a=e[0],i=e[1];return Math.abs(n-a)<=c.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-i)<=c.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))};var c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));e.len=s,e.sub=a,e.mul=i,e.div=o,e.dist=f,e.sqrDist=u,e.sqrLen=h,e.forEach=function(){var t=r();return function(e,n,r,a,i,o){var f=void 0,u=void 0;for(n||(n=2),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,f=r;f<u;f+=n)t[0]=e[f],t[1]=e[f+1],i(t,t,o),e[f]=t[0],e[f+1]=t[1];return e}}()}])});var RedShaderInfo;!function(){var t,e,n,r;(RedShaderInfo=function(a,i,o,f){if(!(this instanceof RedShaderInfo))return new RedShaderInfo(a,i,o,f);if(!(a instanceof RedGL))throw"RedShaderInfo : RedGL 인스턴스만 허용됩니다.";if("string"!=typeof i)throw"RedShaderInfo : key - 문자열만 허용됩니다.";if("string"!=typeof o)throw"RedShaderInfo : type - 문자열만 허용됩니다.";if("string"!=typeof f)throw"RedShaderInfo : source - 문자열만 허용됩니다.";switch(a.__datas.shaderInfo||(a.__datas.shaderInfo={},a.__datas.shaderInfo[RedShaderInfo.FRAGMENT_SHADER]={},a.__datas.shaderInfo[RedShaderInfo.VERTEX_SHADER]={}),e=a.gl,r=a.__datas.shaderInfo,o){case RedShaderInfo.VERTEX_SHADER:n=e.createShader(e.VERTEX_SHADER);break;case RedShaderInfo.FRAGMENT_SHADER:n=e.createShader(e.FRAGMENT_SHADER);break;default:throw"RedShaderInfo : 쉐이더 타입을 확인하세요!"}if(r[o][i])throw i+"는 "+o+"정보에 이미 존재하는 RedShaderInfo 입니다.";if(e.shaderSource(n,f),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw e.getShaderInfoLog(n)+"쉐이더 컴파일에 실패하였습니다.";(t=(t=f.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;/g))||[]).forEach(function(e,n){t[n]=e.trim().replace(";","").split("[")[0]}),this.key=i,this.type=o,this.shader=n,this.parseData=t,this.__UUID=REDGL_UUID++,r[o][i]=this,Object.freeze(this)}).getSourceFromScript=function(){var t,e,n;return function(r){if(!(t=document.getElementById(r)))throw"쉐이더소스가 없음!";for(e="",n=t.firstChild;n;)3==n.nodeType&&(e+=n.textContent),n=n.nextSibling;return e}}(),RedShaderInfo.FRAGMENT_SHADER="fragmentShader",RedShaderInfo.VERTEX_SHADER="vertexShader",Object.freeze(RedShaderInfo)}();var RedProgramInfo;!function(){var t,e,n,r,a;a=[],RedProgramInfo=function(i,o,f,u,s,h){if(!(this instanceof RedProgramInfo))return new RedProgramInfo(i,o,f,u,s,h);if(!(i instanceof RedGL))throw"RedProgramInfo : RedGL 인스턴스만 허용됩니다.";if("string"!=typeof o)throw"RedProgramInfo : key - 문자열만 허용됩니다.";if(!s)throw"RedProgramInfo : onInitUniformValue - 반드시 정의해야합니다.";if(!f instanceof RedShaderInfo)throw"RedProgramInfo : vShaderInfo - RedShaderInfo만 허용됩니다.";if(!u instanceof RedShaderInfo)throw"RedProgramInfo : fShaderInfo - RedShaderInfo만 허용됩니다.";if(f.type!=RedShaderInfo.VERTEX_SHADER)throw"RedProgramInfo : vShaderInfo - VERTEX_SHADER 타입만 허용됩니다.";if(u.type!=RedShaderInfo.FRAGMENT_SHADER)throw"RedProgramInfo : fShaderInfo - FRAGMENT_SHADER 타입만 허용됩니다.";if(i.__datas.RedProgramInfo||(i.__datas.RedProgramInfo={}),(e=i.__datas.RedProgramInfo)[o])throw o+"는 이미 존재하는 RedProgramInfo key 입니다.";if(r=this,t=i.gl,this.key=o,this.attributes={},this.uniforms={},n=t.createProgram(),t.attachShader(n,f.shader),t.attachShader(n,u.shader),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw"프로그램을 초기화 할 수 없습니다.";t.useProgram(n),a.length=0,a.push(f,u),a.forEach(function(e){e.parseData&&e.parseData.forEach(function(e){var a;a={},"attribute"==(e=e.split(" "))[0]?(a.location=t.getAttribLocation(n,e[2]),a.type=e[1],r.attributes[e[2]]=a):(a.location=t.getUniformLocation(n,e[2]),a.location&&(a.location.__UUID=REDGL_UUID++),a.type=e[1],r.uniforms[e[2]]=a)})}),this.program=n,this.shaderInfos={vShaderInfo:f,fShaderInfo:u},this.__UUID=REDGL_UUID++,this.onInitUniformValue=s,this.onDefineTexture=h,e[o]=this,Object.freeze(this)},Object.freeze(RedProgramInfo)}();var RedBufferInfo;!function(){var t,e,n,r;(RedBufferInfo=function(a,i,o,f,u,s,h,c,d,l,R,M){if(!(this instanceof RedBufferInfo))return new RedBufferInfo(a,i,o,f,u,s,h,c,d,l,R,M);if(!(a instanceof RedGL))throw"RedBufferInfo : RedGL 인스턴스만 허용됩니다.";if("string"!=typeof i)throw"RedBufferInfo : bufferType - 문자열만 허용됩니다.";if("string"!=typeof o)throw"RedBufferInfo : key - 문자열만 허용됩니다.";if(i==RedBufferInfo.ARRAY_BUFFER&&"string"!=typeof f)throw"RedBufferInfo : shaderPointerKey - 문자열만 허용됩니다.";if("number"!=typeof s||s!=parseInt(s))throw"RedBufferInfo : pointSize - Integer만 허용됩니다.";if(a.__datas.RedBufferInfo||(a.__datas.RedBufferInfo={}),(e=a.__datas.RedBufferInfo)[o])throw o+"는 이미 존재하는 RedBufferInfo 입니다.";switch(t=a.gl,r=t.createBuffer(),n=i,i){case RedBufferInfo.ARRAY_BUFFER:if(i=t.ARRAY_BUFFER,!(u instanceof Float32Array||u instanceof Float64Array))throw"RedBufferInfo : bufferType - 올바른 TypedArray(RedBufferInfo.ARRAY_BUFFER)형식을 사용해야합니다.";break;case RedBufferInfo.ELEMENT_ARRAY_BUFFER:if(i=t.ELEMENT_ARRAY_BUFFER,!(u instanceof Uint8Array||u instanceof Uint16Array||u instanceof Uint32Array||u instanceof Int8Array||u instanceof Int16Array||u instanceof Int32Array))throw"RedBufferInfo : bufferType - 올바른 TypedArray(RedBufferInfo.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.";break;default:throw"RedBufferInfo : bufferType - 지원하지 않는 버퍼타입입니다. "}if(t.bindBuffer(i,r),t.bufferData(i,u,M=M||t.STATIC_DRAW),this.shaderPointerKey=f,!c)throw"RedBufferInfo : glArrayType - 버퍼데이터의 형식을 지정해주세요";var I=!1;if(u instanceof Int8Array?I=c==t.BYTE:u instanceof Uint8Array?I=c==t.UNSIGNED_BYTE:u instanceof Uint16Array?I=c==t.UNSIGNED_SHORT:u instanceof Uint32Array?I=c==t.UNSIGNED_INT:u instanceof Int16Array?I=c==t.SHORT:u instanceof Int32Array?I=c==t.INT:u instanceof Float32Array&&(I=c==t.FLOAT),!I)throw"RedBufferInfo : glArrayType - arrayData 형식과 glArrayType이 맞지않습니다.";if(this.glArrayType=c,!s)throw"RedBufferInfo : pointSize를 입력하세요";if(this.pointSize=s,"number"!=typeof(h=h||u.length/s)||h!=parseInt(h))throw"pointNum - Integer만 허용됩니다.";if(this.pointNum=h,this.normalize=d||!1,"number"!=typeof(l=l||0)||l!=parseInt(l))throw"RedBufferInfo : stride - Integer만 허용됩니다.";if("number"!=typeof(R=R||0)||R!=parseInt(R))throw"RedBufferInfo : offset - Integer만 허용됩니다.";this.stride=l,this.offset=R,this.enabled=0,this.key=o,this.bufferType=n,this.buffer=r,this.drawMode=M,this.__UUID=REDGL_UUID++,e[o]=this}).ARRAY_BUFFER="arrayBuffer",RedBufferInfo.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBufferInfo)}();var RedFixedAttributeKey;RedFixedAttributeKey={aVertexPosition:"aVertexPosition",aTexcoord:"aTexcoord",aVertexNormal:"aVertexNormal"},Object.freeze(RedFixedAttributeKey);var RedGeometryInfo;!function(){var t,e,n;RedGeometryInfo=function(r,a,i,o,f,u){if(!(this instanceof RedGeometryInfo))return new RedGeometryInfo(r,a,i,o,f,u);if(!(r instanceof RedGL))throw"RedGeometryInfo : RedGL 인스턴스만 허용됩니다.";if(i&&!(i instanceof RedBufferInfo))throw"RedGeometryInfo : verticesBufferInfo는 RedBufferInfo만 가능합니다.";if(o&&!(o instanceof RedBufferInfo))throw"RedGeometryInfo : indicesBufferInfo는 RedBufferInfo만 가능합니다.";if(f&&!(f instanceof RedBufferInfo))throw"RedGeometryInfo : texcoordBufferInfo는 RedBufferInfo만 가능합니다.";if(u&&!(u instanceof RedBufferInfo))throw"RedGeometryInfo : normalBufferInfo는 RedBufferInfo만 가능합니다.";if(i&&i.bufferType!=RedBufferInfo.ARRAY_BUFFER)throw"RedGeometryInfo : verticesBufferInfo는 ARRAY_BUFFER만 가능합니다.";if(o&&o.bufferType!=RedBufferInfo.ELEMENT_ARRAY_BUFFER)throw"RedGeometryInfo : indicesBufferInfo는 ELEMENT_ARRAY_BUFFER만 가능합니다.";if(f&&f.bufferType!=RedBufferInfo.ARRAY_BUFFER)throw"RedGeometryInfo : texcoordBufferInfo는 ARRAY_BUFFER만 가능합니다.";if(u&&u.bufferType!=RedBufferInfo.ARRAY_BUFFER)throw"RedGeometryInfo : normalBufferInfo는 ARRAY_BUFFER만 가능합니다.";if(r.__datas.RedGeometryInfo||(r.__datas.RedGeometryInfo={}),(e=r.__datas.RedGeometryInfo)[a])throw"RedGeometryInfo : "+a+"는 이미 존재하는 RedGeometryInfo 입니다.";if(t=r.gl,this.attributes={},this.indices=null,this.key=a,i){if(i.shaderPointerKey!=RedFixedAttributeKey.aVertexPosition)throw"RedGeometryInfo : verticesBufferInfo의 shaderPointerKey는 aVertexPosition만 가질수있습니다.";this.attributes.vertexPosition=i}if(f){if(f.shaderPointerKey!=RedFixedAttributeKey.aTexcoord)throw"RedGeometryInfo : texcoordBufferInfo의 shaderPointerKey는 aTexcoord만 가질수있습니다.";this.attributes.texcoord=f}if(u){if(u.shaderPointerKey!=RedFixedAttributeKey.aVertexNormal)throw"RedGeometryInfo : normalBufferInfo의 shaderPointerKey는 aVertexNormal만 가질수있습니다.";this.attributes.normal=u}this.__attributeList=[];for(n in this.attributes)this.__attributeList.push(this.attributes[n]);this.indices=o,this.__UUID=REDGL_UUID++,e[a]=this},Object.freeze(RedGeometryInfo)}();var RedPrimitive;!function(){var t,e,n,r;r=function(t){return t.__datas.RedPrimitive||(t.__datas.RedPrimitive={}),t.__datas.RedPrimitive},n=function(t,e,n,r,a,i){return n=new Float32Array(n),r=new Uint16Array(r),a=new Float32Array(a),i=new Float32Array(i),n=t.createArrayBufferInfo(e+"_vertices",RedFixedAttributeKey.aVertexPosition,n,3,n.length/3,t.gl.FLOAT),r=t.createIndexBufferInfo(e+"_indices",r,1,r.length,t.gl.UNSIGNED_SHORT),a&&(a=t.createArrayBufferInfo(e+"_uvs",RedFixedAttributeKey.aTexcoord,a,2,a.length/2,t.gl.FLOAT)),i&&(i=t.createArrayBufferInfo(e+"_normals",RedFixedAttributeKey.aVertexNormal,i,3,i.length/3,t.gl.FLOAT)),t.createGeometryInfo(e,n,r,a,i)},(RedPrimitive={}).plane=function(){var a,i,o,f,u,s,h,c,d,l,R,M,I,_,m,E;return function v(A,T,b,g,p){if(!(this instanceof v))return new v(A,T,b,g,p);if(!(A instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";if(T=T||1,b=b||1,p=p||1,p=p||1,a=T/2,i=b/2,o=Math.floor(g)||1,f=Math.floor(p)||1,u=o+1,s=f+1,h=T/o,c=b/f,e=r(A),t="RedPrimitivePlane_"+T+"_"+b+"_"+g+"_"+p,e[t])return e[t];var x=[],w=[],y=[],U=[];for(l=0;l<s;l++)for(M=l*c-i,d=0;d<u;d++)R=d*h-a,x.push(R,-M,0),U.push(0,0,1),y.push(d/o,1-l/f);for(l=0;l<f;l++)for(d=0;d<o;d++)I=d+u*l,_=d+u*(l+1),m=d+1+u*(l+1),E=d+1+u*l,w.push(I,_,E,_,m,E);return e[t]=n(A,t,x,w,y,U),e[t]}}(),RedPrimitive.cube=function(){var a,i,o;return o=function(t,e,n,r,o,f,u,s,h,c,d,l,R,M,I){var _,m,E=c/R,v=d/M,A=c/2,T=d/2,b=l/2,g=R+1,p=M+1,x=0,w=0,y=[];for(m=0;m<p;m++){var U=m*v-T;for(_=0;_<g;_++){var S=_*E-A;y[o]=S*s,y[f]=U*h,y[u]=b,t.push(y.x,y.y,y.z),y[o]=0,y[f]=0,y[u]=l>0?1:-1,r.push(y.x,y.y,y.z),n.push(_/R),n.push(1-m/M),x+=1}}for(m=0;m<M;m++)for(_=0;_<R;_++){var L=a+_+g*m,P=a+_+g*(m+1),D=a+(_+1)+g*(m+1),N=a+(_+1)+g*m;e.push(L,P,N),e.push(P,D,N),w+=6}i+=w,a+=x},function f(u,s,h,c,d,l,R){if(!(this instanceof f))return new f(u,s,h,c,d,l,R);if(!(u instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";if(s=s||1,h=h||1,c=c||1,d=Math.floor(d)||1,l=Math.floor(l)||1,R=Math.floor(R)||1,e=r(u),t="RedPrimitiveCube_"+s+"_"+h+"_"+c+"_"+d+"_"+l+"_"+R,e[t])return e[t];var M=[],I=[],_=[],m=[];return a=0,i=0,o(M,I,_,m,"z","y","x",-1,-1,c,h,s,R,l),o(M,I,_,m,"z","y","x",1,-1,c,h,-s,R,l),o(M,I,_,m,"x","z","y",1,1,s,c,h,d,R),o(M,I,_,m,"x","z","y",1,-1,s,c,-h,d,R),o(M,I,_,m,"x","y","z",1,-1,s,h,c,d,l),o(M,I,_,m,"x","y","z",-1,-1,s,h,-c,d,l),e[t]=n(u,t,M,I,_,m),e[t]}}(),RedPrimitive.grid=function(){var a,i,o,f,u,s,h,c;return function d(l,R,M){if(!(this instanceof d))return new d(l,R,M);if(!(l instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";if(e=r(l),R=R||50,M=M||50,t="RedPrimitiveFloor_"+R+"_"+M,e[t])return e[t];var I=[],_=[];for(o=2*(a=R)/(i=M),f=0;f<=i;f++)u=f*o,c=6*(s=i+1),I[h=6*f]=-a,I[h+1]=0,I[h+2]=-a+u,I[h+3]=a,I[h+4]=0,I[h+5]=-a+u,I[c+h]=-a+u,I[c+h+1]=0,I[c+h+2]=-a,I[c+h+3]=-a+u,I[c+h+4]=0,I[c+h+5]=a,_[2*f]=2*f,_[2*f+1]=2*f+1,_[2*s+2*f]=2*s+2*f,_[2*s+2*f+1]=2*s+2*f+1;return e[t]=n(l,t,I,_),e[t]}}(),RedPrimitive.sphere=function(){var a,i,o,f,u,s,h,c,d=[],l=new Float32Array([0,0,0]),R=new Float32Array([0,0,0]);return function M(I,_,m,E,v,A,T,b){if(!(this instanceof M))return new M(I,_,m,E,v,A,T,b);if(!(I instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";if(_=_||1,m=Math.max(3,Math.floor(m)||8),E=Math.max(2,Math.floor(E)||6),v=void 0!==v?v:0,A=void 0!==A?A:2*Math.PI,T=void 0!==T?T:0,b=void 0!==b?b:Math.PI,a=T+b,f=0,d.length=0,l[0]=0,l[1]=0,l[2]=0,R[0]=0,R[1]=0,R[2]=0,e=r(I),t="RedPrimitiveSphere_"+_+"_"+m+"_"+E+"_"+v+"_"+A+"_"+T+"_"+b,e[t])return e[t];var g=[],p=[],x=[],w=[];for(o=0;o<=E;o++){var y=[],U=o/E;for(i=0;i<=m;i++){var S=i/m;l.x=-_*Math.cos(v+S*A)*Math.sin(T+U*b),l.y=_*Math.cos(T+U*b),l.z=_*Math.sin(v+S*A)*Math.sin(T+U*b),g.push(l.x,l.y,l.z),R[0]=l.x,R[1]=l.y,R[2]=l.z,vec3.normalize(R,R),w.push(R[0],R[1],R[2]),x.push(S,1-U),y.push(f++)}d.push(y)}for(o=0;o<E;o++)for(i=0;i<m;i++)u=d[o][i+1],s=d[o][i],h=d[o+1][i],c=d[o+1][i+1],(0!==o||T>0)&&p.push(u,s,c),(o!==E-1||a<Math.PI)&&p.push(s,h,c);return e[t]=n(I,t,g,p,x,w),e[t]}}(),RedPrimitive.cone=function a(i,o,f,u,s,h,c,d){if(!(this instanceof a))return new a(i,o,f,u,s,h,c,d);if(!(i instanceof RedGL))throw"RedPrimitive : RedGL 인스턴스만 허용됩니다.";if(s=h?s:3,h=h||1,u=u||1,f=f||1,o=o||1,e=r(i),t="RedPrimitiveCone_"+o+"_"+f+"_"+u+"_"+s+"_"+h+"_"+c+"_"+d,e[t])return e[t];for(var l=[],R=[],M=[],I=[],_=void 0===c||c,m=void 0===d||d,E=(_?2:0)+(m?2:0),v=s+1,A=Math.atan2(o-f,u),T=Math.cos(A),b=Math.sin(A),g=h+(m?2:0),p=_?-2:0;p<=g;++p){var x,w=p/h,y=u*w;p<0?(y=0,w=1,x=o):p>h?(y=u,w=1,x=f):x=o+p/h*(f-o),-2!==p&&p!==h+2||(x=0,w=0),y-=u/2;for(L=0;L<v;++L){var U=Math.sin(L*Math.PI*2/s),S=Math.cos(L*Math.PI*2/s);l.push(U*x,y,S*x),I.push(p<0||p>h?0:U*T,p<0?-1:p>h?1:b,p<0||p>h?0:S*T),M.push(L/s,1-w)}}for(p=0;p<h+E;++p)for(var L=0;L<s;++L)R.push(v*(p+0)+0+L,v*(p+0)+1+L,v*(p+1)+1+L),R.push(v*(p+0)+0+L,v*(p+1)+1+L,v*(p+1)+0+L);return e[t]=n(i,t,l,R,M,I),e[t]},Object.freeze(RedPrimitive)}();var RedMaterialInfo;!function(){var t,e,n,r,a,i;n={f:{16:"uniformMatrix4fv",12:"uniformMatrix3fv",8:"uniformMatrix2fv",4:"uniform4fv",3:"uniform3fv",2:"uniform2fv",1:"uniform1fv"},i:{16:"uniformMatrix4iv",12:"uniformMatrix3iv",8:"uniformMatrix2iv",4:"uniform4iv",3:"uniform3iv",2:"uniform2iv",1:"uniform1iv"}},(RedMaterialInfo=function(n,r,a,o,f,u,s,h){if(!(this instanceof RedMaterialInfo))return new RedMaterialInfo(n,r,a,o,f,u,s,h);if(!(n instanceof RedGL))throw"RedMaterialInfo : RedGL 인스턴스만 허용됩니다.";if("string"!=typeof r)throw"RedMaterialInfo : typeName은 문자열만 허용됩니다.";if(t=n.__datas.RedMaterialDefine,e=t[r],i=n.gl,!e)throw r+"재질은 존재하지않습니다.";this.programInfo=e.programInfo,a&&(this[RedMaterialInfo.DIFFUSE_TEXTURE]=a),o&&(this[RedMaterialInfo.NORMAL_TEXTURE]=o),f&&(this[RedMaterialInfo.DISPLACEMENT_TEXTURE]=f),u&&(this[RedMaterialInfo.SPECULAR_TEXTURE]=u),s&&(this[RedMaterialInfo.REFLECTION_TEXTURE]=s),h&&(this[RedMaterialInfo.REFRACTION_TEXTURE]=h),this.materialUniforms={},this.programInfo.onInitUniformValue(this),this.needUniformList=!0,this.updateUniformList(),this.__UUID=REDGL_UUID++}).prototype.updateUniformList=function(){this.programInfo.onDefineTexture&&this.programInfo.onDefineTexture(this);for(r in this.materialUniforms)if((a=this.materialUniforms[r])instanceof Float32Array||a instanceof Float64Array)a.__uniformMethod=n.f[a.length],a.__isMatrix=a.__uniformMethod.length>11;else if(a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array)a.__uniformMethod=n.i[a.length],a.__isMatrix=a.__uniformMethod.length>11;else if(null==a);else if("number"==typeof a);else if(a instanceof RedAtlasUVInfo);else if(a instanceof RedTextureInfo||a instanceof RedCubeTextureInfo);else{if(!(a instanceof RedAtlasTextureInfo))throw"RedMaterialInfo : "+r+"는 올바르지 않은 타입입니다.";this.materialUniforms.uAtlascoord=a.atlasUVInfo}this.__uniformList=[];var t,e,i=this.materialUniforms,o=this.programInfo.uniforms;for(r in i){if(t=void 0,!o.hasOwnProperty(r))throw"RedMaterialInfo : 유니폼명 : "+r+" / 쉐이더에 정의되지 않은 유니폼에 접근하려고합니다.";"samplerCube"!=(e=o[r].type)&&"sampler2D"!=e||(t=RedConst.SAMPLER),"vec2"!=e&&"vec3"!=e&&"vec4"!=e||(t=RedConst.VEC),"mat2"!=e&&"mat3"!=e&&"mat4"!=e||(t=RedConst.MAT),"uAtlascoord"==r&&(t=RedConst.ATLASCOORD),"int"==e&&(t=RedConst.INT),"float"==e&&(t=RedConst.FLOAT),this.__uniformList.push({key:r,type:e,renderType:t,value:i[r],location:o[r].location}),this[r]=i[r]}this.needUniformList=!1},RedMaterialInfo.prototype.setTexture=function(t,e){if(!(e instanceof RedTextureInfo||e instanceof RedCubeTextureInfo||e instanceof RedAtlasUVInfo||null==e||void 0==e))throw"RedMaterialInfo : setTexture - "+e+"은 텍스쳐 형식이 아닙니다.";this[t]=e,this.updateUniformList()},RedMaterialInfo.DIFFUSE_TEXTURE="uDiffuseTexture",RedMaterialInfo.NORMAL_TEXTURE="uNormalTexture",RedMaterialInfo.DISPLACEMENT_TEXTURE="uDisplacementTexture",RedMaterialInfo.SPECULAR_TEXTURE="uSpecularTexture",RedMaterialInfo.REFLECTION_TEXTURE="uReflectionTexture",RedMaterialInfo.REFRACTION_TEXTURE="uRefractionTexture",Object.freeze(RedMaterialInfo)}();var RedMaterialDefine;!function(){var t,e,n,r,a,i;r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",RedMaterialDefine=function(o,f){if(!(this instanceof RedMaterialDefine))return new RedMaterialDefine(o,f);if(!(o instanceof RedGL))throw"RedMaterialDefine : RedGL 인스턴스만 허용됩니다.";if(!(f instanceof RedProgramInfo))throw"RedMaterialDefine : RedProgramInfo 인스턴스만 허용됩니다.";if(o.__datas.RedMaterialDefine||(o.__datas.RedMaterialDefine={}),n=o.gl,e=f.key,(t=o.__datas.RedMaterialDefine)[e])throw e+"는 이미 존재하는 RedMaterialDefine 입니다.";this.programInfo=f,this.__UUID=REDGL_UUID++,t[e]=this,Object.freeze(this),a=this.programInfo.uniforms,i=i||o.createCubeTextureInfo([r,r,r,r,r,r]),a.uUseReflectionTexture&&(n.activeTexture(n.TEXTURE0+RedTextureIndex.CUBE_REFLECTION),n.bindTexture(n.TEXTURE_CUBE_MAP,i.texture),n.uniform1i(a.uReflectionTexture.location,RedTextureIndex.CUBE_REFLECTION)),a.uReflectionTexture&&(n.activeTexture(n.TEXTURE0+RedTextureIndex.CUBE_REFRACTION),n.bindTexture(n.TEXTURE_CUBE_MAP,i.texture),n.uniform1i(a.uRefractionTexture.location,RedTextureIndex.CUBE_REFRACTION))},Object.freeze(RedMaterialDefine)}();var RedMeshBaseInfo;!function(){var t;RedMeshBaseInfo=function(e){t=e.gl,Object.defineProperty(this,"uMVMatrix",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"uNMatrix",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"__parentMVMatrixClone",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"position",{value:new Float32Array([0,0,0]),enumerable:!0}),Object.defineProperty(this,"rotation",{value:new Float32Array([0,0,0]),enumerable:!0}),Object.defineProperty(this,"scale",{value:new Float32Array([1,1,1]),enumerable:!0}),this.geometryInfo=null,this.materialInfo=null,this.drawMode=t.TRIANGLES,this.useCullFace=!0,this.cullFace=t.BACK,this.useBlendMode=!0,this.blendFactor1=t.ONE,this.blendFactor2=t.ONE_MINUS_SRC_ALPHA,this.useDepthTest=!0,this.depthTestFunc=t.LESS,this.children=[],this.__UUID=REDGL_UUID++},Object.freeze(RedMeshBaseInfo)}();var RedMeshInfo;!function(){var t,e;RedMeshInfo=function(n,r,a,i){if(!(this instanceof RedMeshInfo))return new RedMeshInfo(n,r,a,i);if(!(n instanceof RedGL))throw"RedMeshInfo : RedGL 인스턴스만 허용됩니다.";if("string"!=typeof r)throw"RedMeshInfo : key - 문자열만 허용됩니다.";if(!(a instanceof RedGeometryInfo))throw"RedMeshInfo : geometryInfo - RedGeometryInfo만 허용됩니다.";if(!(i instanceof RedMaterialInfo))throw"RedMeshInfo : materialInfo - RedMaterialInfo만 허용됩니다.";if(t=n.gl,n.__datas.RedMeshInfo||(n.__datas.RedMeshInfo={}),(e=n.__datas.RedMeshInfo)[r])throw r+"는 이미 존재하는 RedMeshInfo 입니다.";RedMeshBaseInfo.call(this,n),this.geometryInfo=a,this.materialInfo=i,e[r]=this},Object.freeze(RedMeshInfo)}();var RedBaseCameraInfo;!function(){var t;(RedBaseCameraInfo=function(e,n){if(!(this instanceof RedBaseCameraInfo))return new RedBaseCameraInfo(e,n);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if("string"!=typeof n)throw"key는 문자열만 허용됩니다.";if(e.__datas.RedBaseCameraInfo||(e.__datas.RedBaseCameraInfo={}),(t=e.__datas.RedBaseCameraInfo)[n])throw n+"는 이미 존재하는 RedBaseCameraInfo 입니다.";Object.defineProperty(this,"uPMatrix",{value:mat4.create(),enumerable:!0}),Object.defineProperty(this,"uCameraMatrix",{value:mat4.create(),enumerable:!0}),this.fov=45,this.aspect=.1,this.near=.1,this.far=1e4,Object.defineProperty(this,"__desiredCoords",{value:new Float32Array([0,0,0]),enumerable:!0}),Object.defineProperty(this,"__desiredRotation",{value:new Float32Array([0,0,0]),enumerable:!0}),this.__UUID=REDGL_UUID++,this.__canvas=e.__canvas,this.update(),t[n]=this}).prototype={setPosition:function(t,e,n){return this.__desiredCoords[0]=t,this.__desiredCoords[1]=e,this.__desiredCoords[2]=n,this},moveForward:function(t){},moveBack:function(t){},moveLeft:function(t){},moveRight:function(t){},moveUp:function(t){},moveDown:function(t){},lookAt:function(){var t=new Float32Array([0,1,0]);return function(e){mat4.lookAt(this.uCameraMatrix,this.__desiredCoords,e,t)}}(),update:function(){return this.aspect=this.__canvas.width/this.__canvas.height,mat4.identity(this.uPMatrix),mat4.perspective(this.uPMatrix,this.fov*Math.PI/180,this.aspect,this.near,this.far),this}},Object.freeze(RedBaseCameraInfo)}();var RedAmbientLightInfo;!function(){var t;(RedAmbientLightInfo=function(e){if(!(this instanceof RedAmbientLightInfo))return new RedAmbientLightInfo(e);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";e.__datas.RedAmbientLightInfo||(e.__datas.RedAmbientLightInfo={}),t=e.__datas.RedAmbientLightInfo,this.color=new Float32Array([.03,.03,.03,1]),this.__UUID=REDGL_UUID++,Object.seal(this)}).TYPE="ambient",Object.freeze(RedAmbientLightInfo)}();var RedDirectionalLightInfo;!function(){var t;(RedDirectionalLightInfo=function(e){if(!(this instanceof RedDirectionalLightInfo))return new RedDirectionalLightInfo(e);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";e.__datas.RedDirectionalLightInfo||(e.__datas.RedDirectionalLightInfo={}),t=e.__datas.RedDirectionalLightInfo,this.color=new Float32Array([1,1,1,1]),this.direction=new Float32Array([0,0,0]),this.__UUID=REDGL_UUID++,Object.seal(this)}).TYPE="directional",Object.freeze(RedDirectionalLightInfo)}();var RedPointLightInfo;!function(){var t;(RedPointLightInfo=function(e){if(!(this instanceof RedPointLightInfo))return new RedPointLightInfo(e);if(!(e instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";e.__datas.RedPointLightInfo||(e.__datas.RedPointLightInfo={}),t=e.__datas.RedPointLightInfo,this.color=new Float32Array([1,1,1,1]),this.position=new Float32Array([0,0,0]),this.radius=1,this.useDebugMode=!1,this.__UUID=REDGL_UUID++,this.__debugMesh=e.createMeshInfo("RedPointLightInfo__debugMesh"+this.__UUID,RedPrimitive.sphere(e,.5,16,16,16),e.createMaterialInfo("color")),this.__debugMesh.children.push(e.createMeshInfo("RedPointLightInfo__debugMesh"+this.__UUID+"_center",RedPrimitive.sphere(e,.01,1,1,1),e.createMaterialInfo("color"))),this.__debugMesh.drawMode=e.gl.LINE_STRIP,this.__debugMesh.children[0].drawMode=e.gl.LINE_STRIP,Object.seal(RedAmbientLightInfo)}).TYPE="point",Object.freeze(RedPointLightInfo)}();var RedTextureIndex;RedTextureIndex={PASS:128,CREATE:1,DIFFUSE:2,NORMAL:3,DISPLACEMENT:4,SPECULAR:5,CUBE_CREATE:0,CUBE_DIFFUSE:6,CUBE_REFLECTION:6,CUBE_REFRACTION:7},Object.freeze(RedTextureIndex);var RedTextureInfo;!function(){var t,e;(RedTextureInfo=function(n,r,a,i,o,f){if(!(this instanceof RedTextureInfo))return new RedTextureInfo(n,r,a,i,o,f);if(!(n instanceof RedGL))throw"RedTextureInfo : RedGL 인스턴스만 허용됩니다.";if(void 0==r)throw"RedTextureInfo : src는 문자열과 캔버스 오브젝트만 허용됩니다.";if(void 0!=r&&"string"!=typeof r&&!(r instanceof Element&&"CANVAS"==r.nodeName))throw"RedTextureInfo : src는 문자열과 캔버스 오브젝트만 허용됩니다.";var u,s,h;h=this,t=n.gl,i=i||t.RGBA,o=o||t.RGBA,f=f||t.UNSIGNED_BYTE,a=void 0==a?RedTextureIndex.DIFFUSE:a,e||(e=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,i,2,2,0,o,f,new Uint8Array([222,222,222,0,0,222,222,0,222,222,0,0,222,222,222,222])),t.generateMipmap(t.TEXTURE_2D)),u=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),(s=new Image).crossOrigin="anonymous",s.style.minHeight="1px",s.onload=function(){h.loaded=1,h.__targetIndex=a,t.activeTexture(t.TEXTURE0+RedTextureIndex.CREATE),t.bindTexture(t.TEXTURE_2D,h.texture),t.texImage2D(t.TEXTURE_2D,0,i,o,f,h.__img),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D)},void 0!=r&&(s.src=r instanceof Element?r.toDataURL():r),this.loaded=0,this.texture=u,this.__img=s,this.__webglTextureYn=1,this.__webglTexture=1,this.__UUID=REDGL_UUID++,this.__targetIndex=RedTextureIndex.CREATE}).prototype.updateTexture=function(t){this.loaded=0,this.__img.src=t instanceof Element?t.toDataURL():t}}();var RedCubeTextureInfo;!function(){var t;(RedCubeTextureInfo=function(e,n,r){if(!(this instanceof RedCubeTextureInfo))return new RedCubeTextureInfo(e,n,r);if(!(e instanceof RedGL))throw"RedCubeTextureInfo : RedGL 인스턴스만 허용됩니다.";if(!(n instanceof Array))throw"RedCubeTextureInfo : srcList는 Array만 허용됩니다.";var a,i;i=this,t=e.gl,a=0;var o=n.length;for(this.__imgList=[];o--;){var f,u=new Image;if(void 0!=(f=n[o])&&"string"!=typeof f&&!(f instanceof Element&&"CANVAS"==f.nodeName))throw"RedTextureInfo : src는 문자열과 캔버스 오브젝트만 허용됩니다.";u.onload=function(){6==++a&&i.__allLoaed(t)},u.src=f instanceof Element?f.toDataURL():f,this.__imgList[o]=u}this.loaded=0,this.texture=t.createTexture(),t.activeTexture(t.TEXTURE0+RedTextureIndex.CUBE_CREATE),t.bindTexture(t.TEXTURE_CUBE_MAP,this.texture),r=void 0==r?RedTextureIndex.CUBE_CREATE:r,this.__targetIndex=RedTextureIndex.CUBE_CREATE,this.__allLoadedTargetIndex=r,this.__webglTextureYn=1,this.__webglCubeTexture=1,this.__UUID=REDGL_UUID++}).prototype.__allLoaed=function(){t.activeTexture(t.TEXTURE0+RedTextureIndex.CUBE_CREATE),t.bindTexture(t.TEXTURE_CUBE_MAP,this.texture),this.__targetIndex=this.__allLoadedTargetIndex,this.__imgList.forEach(function(e,n){t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_CUBE_MAP),this.loaded=1}}();var Atlas;!function(){var t;(t=function(t,e,n,r){this.x=t,this.y=e,this.w=n,this.h=r}).prototype.fitsIn=function(t){return t.w>=this.w&&t.h>=this.h},t.prototype.sameSizeAs=function(t){return this.w===t.w&&this.h===t.h},(Atlas=function(e,n,r,a){1===arguments.length&&(this.canvas=e,e=n=0,r=this.canvas.width,a=this.canvas.height),2===arguments.length&&(r=e,a=n,e=n=0),this.left=this.right=null,this.rect=new t(e,n,r,a),this.filled=!1,this.tilepad=!1,this._cache=[],this._uvcache=Object.create(null)}).prototype.pack=function(t){return this._cache=[],this._uvcache=Object.create(null),t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t)),null!==this.left?this._ontoCanvas(this.left.pack(t)||this.right.pack(t)):!(this.filled||!t.fitsIn(this.rect))&&(t.sameSizeAs(this.rect)?(this.filled=!0,this._ontoCanvas(this)):(this.rect.w-t.w>this.rect.h-t.h?(this.left=new Atlas(this.rect.x,this.rect.y,t.w,this.rect.h),this.right=new Atlas(this.rect.x+t.w,this.rect.y,this.rect.w-t.w,this.rect.h)):(this.left=new Atlas(this.rect.x,this.rect.y,this.rect.w,t.h),this.right=new Atlas(this.rect.x,this.rect.y+t.h,this.rect.w,this.rect.h-t.h)),this._ontoCanvas(this.left.pack(t))))},Atlas.prototype.expand=function(t){var e=this;t=this._toRect(t),this.img&&this.tilepad&&(t=this._tilepad(t));var n;if(this.rect.w<this.rect.h?((n=new Atlas(0,0,this.rect.w+t.w,this.rect.h)).right=new Atlas(this.rect.w,0,t.w,this.rect.h),n.left=this):((n=new Atlas(0,0,this.rect.w,this.rect.h+t.h)).right=new Atlas(0,this.rect.h,this.rect.w,t.h),n.left=this),["canvas","context","img"].forEach(function(t){e[t]&&(n[t]=e[t],e[t]=null)}),n.canvas){n.context||(n.context=n.canvas.getContext("2d"));var r=n.context.getImageData(0,0,n.canvas.width,n.canvas.height);n.canvas.width=n.rect.w,n.canvas.height=n.rect.h,n.context.putImageData(r,0,0)}return!1===n.pack(t)?n.expand(t):n},Atlas.prototype.index=function(){var t=this;return t._cache.length>0?t._cache:(function e(n){null!==n.left?(e(n.left),e(n.right)):n.rect.name&&t._cache.push(n.rect)}(t),t._cache)},Atlas.prototype.uv=function(t,e){var n=this;t=t||n.rect.w,e=e||n.rect.h;var r=this.tilepad;return function a(i){if(null!==i.left)a(i.left),a(i.right);else if(void 0!==i.rect.name){var o=r?i.rect.w/4:0;n._uvcache[i.rect.name]=[[i.rect.x+o,i.rect.y+o],[i.rect.x+o+(i.rect.w-2*o),i.rect.y+o],[i.rect.x+o+(i.rect.w-2*o),i.rect.y+o+(i.rect.h-2*o)],[i.rect.x+o,i.rect.y+o+(i.rect.h-2*o)]].map(function(n){return 0!==n[0]&&(n[0]=n[0]/t),0!==n[1]&&(n[1]=n[1]/e),n})}}(n),n._uvcache},Atlas.prototype.json=function(t){var e=this;return t?("string"==typeof t&&(t=JSON.parse(t)),function t(e){if(e&&e.rect){var n=new Atlas(e.rect.x,e.rect.y,e.rect.w,e.rect.h);return e.left&&(n.left=t(e.left)),e.right&&(n.right=t(e.right)),n}}(t)):JSON.stringify(function t(e){var n={left:null,right:null,rect:e.rect,filled:e.filled};return null!==e.left&&(n.left=t(e.left),n.right=t(e.right)),n}(e),null,2)},Atlas.prototype._tilepad=function(e){var n=this.img;if(!n)return e;var r=n.width/2,a=document.createElement("canvas");a.name=n.name||n.src,a.id=n.id||"",a.width=n.width+n.width,a.height=n.height+n.height;var i=a.getContext("2d"),o=i.createPattern(n,"repeat");return i.fillStyle=o,i.translate(r,r),i.fillRect(-r,-r,a.width+r,a.height+r),i.translate(-r,-r),this.img=a,new t(e.x,e.y,this.img.width,this.img.height)},Atlas.prototype._ontoCanvas=function(t){return t&&this.img&&this.canvas&&(this.context||(this.context=this.canvas.getContext("2d")),this.canvas.ctx=this.context,this.context.clearRect(t.rect.x,t.rect.y,t.rect.w,t.rect.h),this.context.drawImage(this.img,t.rect.x,t.rect.y,t.rect.w,t.rect.h),t.rect.name=this.img.id||this.img.name||this.img.src||null),t},Atlas.prototype._toRect=function(e){return!e.nodeName||"IMG"!==e.nodeName&&"CANVAS"!==e.nodeName||(this.img=e,e=new t(e.x,e.y,e.width,e.height)),e instanceof t||(e=new t(e.x||0,e.y||0,e.w||e.width,e.h||e.height)),e},Atlas.prototype._debug=function(){if(this.canvas){var t=this.canvas.getContext("2d");this.index().forEach(function(e){t.lineWidth=1,t.strokeStyle="red",t.strokeRect(e.x,e.y,e.w,e.h)})}}}();var RedAtlasUVInfo;RedAtlasUVInfo=function(){var t;return t=[0,0,1,1].toString(),function(e){if(!(this instanceof RedAtlasUVInfo))return new RedAtlasUVInfo(e);if(!(e instanceof Array))throw"uvArray는 Array만 허용합니다.";this.value=new Float32Array(e),this.value.__UUID=this.__UUID=e.toString()==t?1:REDGL_UUID++,Object.freeze(this)}}();var RedAtlasInfo;RedAtlasInfo=function(t,e){if(!(this instanceof RedAtlasInfo))return new RedAtlasInfo(t,e);if(!(t instanceof RedGL))throw"RedAtlasInfo : RedGL 인스턴스만 허용됩니다.";if(!(e instanceof Atlas))throw"RedAtlasInfo : Atlas 인스턴스만 허용됩니다.";this.atlas=e,this.textureInfo=void 0};var RedAtlasTextureManager;!function(){var t,e,n,r,a,i,o,f,u;r={},n=[],f=function(e){var r;if(e&&(e.width>t||e.height>t))throw t+" - 최대 허용사이즈보다 이미지가 큽니다.";(r=document.createElement("canvas")).width=t,r.height=t,r.style.background="transparent",r.style.margin="3px",r.style.display="inline-block",i++,(o=new Atlas(r)).atlasInfo=RedAtlasInfo(a,o),o.atlasInfo.textureInfo=RedTextureInfo(a,o.canvas,i),o.atlasInfo.__targetIndex=i,n.push(o.atlasInfo)},u=function(t){var e,a,i=(o=n[0].atlas).pack(t);if(!1===i){for(e=0,a=n.length,e;e<a&&(o=n[e].atlas,!(i=o.pack(t)));e++);!1===i&&(f(t),i=o.pack(t))}return r[t.id]=new RedAtlasTextureInfo(o.uv()[t.id],o.atlasInfo),i},(RedAtlasTextureManager=function(s,h,c){if(!(this instanceof RedAtlasTextureManager))return new RedAtlasTextureManager(s,h,c);if(!(s instanceof RedGL))throw"RedAtlasTextureManager : RedGL 인스턴스만 허용됩니다.";if("string"==typeof h&&(h=[h]),!(h instanceof Array)&&"string"!=typeof h)throw"RedAtlasTextureManager : srcList는 문자열 또는 Array만 허용됩니다.";a=s,t=s.detect.MAX_TEXTURE_SIZE,e=s.detect.MAX_COMBINED_TEXTURE_IMAGE_UNITS,void 0==i&&(i=e-parseInt(e/5)),t>4096&&(t=4096),o||f();var d,l;return d=0,l=0,h.forEach(function(t){var e=new Image,a=t;r[a]||(e.id=a,e.src=t,l++,e.onload=function(){u(this);l==++d&&(n.forEach(function(t){t.textureInfo.updateTexture(t.atlas.canvas)}),c&&c(h))})}),RedAtlasTextureManager}).getByKey=function(t){return r[t]},Object.freeze(RedAtlasTextureManager)}();var RedAtlasTextureInfo;!function(){var t;t={};var e,n,r;r=function(r){return e=[r[0][0],1-r[2][1],r[1][0]-r[0][0],r[2][1]-r[0][1]],n=e.toString(),r=t[n]?t[n]:t[n]=RedAtlasUVInfo(e)},(RedAtlasTextureInfo=function(t,e){if(!(this instanceof RedAtlasTextureInfo))return new RedAtlasTextureInfo(t,e);if(!(t instanceof Array))throw"atlasUVInfo는 Array만 허용합니다.";if(!(e instanceof RedAtlasInfo))throw"parentAtlasInfo는 RedAtlasInfo  인스턴스만 허용합니다.";t=r(t),this.atlasUVInfo=t,this.parentAtlasInfo=e,this.__webglAtlasTexture=1,this.__webglTextureYn=1,Object.freeze(this)}).prototype.setAtlasUVInfo=r}();var RedSkyBoxInfo;RedSkyBoxInfo=function(t,e){if(!(this instanceof RedSkyBoxInfo))return new RedSkyBoxInfo(t,e);if(!(t instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";if(!(e instanceof Array))throw"srcList는 Array만 허용됩니다.";if(6!=e.length)throw"srcList는 6개여야 합니다.";RedMeshBaseInfo.call(this,t),this.materialInfo=RedMaterialInfo(t,"skyBox",RedCubeTextureInfo(t,e,RedTextureIndex.CUBE_DIFFUSE)),this.geometryInfo=RedPrimitive.cube(t),this.scale[0]=1e3,this.scale[1]=1e3,this.scale[2]=1e3,this.cullFace=t.gl.FRONT},Object.freeze(RedSkyBoxInfo);var RedSceneInfo;!function(){var t;(RedSceneInfo=function(e,n,r){if(!(this instanceof RedSceneInfo))return new RedSceneInfo(e,n,r);if(!(e instanceof RedGL))throw"RedSceneInfo : RedGL 인스턴스만 허용됩니다.";if("string"!=typeof n)throw"RedSceneInfo : key는 문자열만 허용됩니다.";if(void 0==r&&(r=RedBaseCameraInfo(testGL,"autoInitCamera"+REDGL_UUID)),!(r instanceof RedBaseCameraInfo))throw"RedSceneInfo : camera는 RedBaseCameraInfo 인스턴스만 허용됩니다.";if(e.__datas.RedSceneInfo||(e.__datas.RedSceneInfo={}),(t=e.__datas.RedSceneInfo)[n])throw n+"는 이미 존재하는 RedSceneInfo 입니다.";this.children=[],this.camera=r,this.lights={ambient:[],directional:[],point:[],spot:[]},this.__UUID=REDGL_UUID++,t[n]=this,Object.seal(RedSceneInfo)}).prototype={setSkyBox:function(t){if(!(t instanceof RedSkyBoxInfo))throw"RedSceneInfo : RedSkyBoxInfo 인스턴스만 허용됩니다.";this.skyBox=t},setGrid:function(t){this.grid=t},addLight:function(){var t;return function(e){if(e instanceof RedDirectionalLightInfo){if(5==(t=this.lights[RedDirectionalLightInfo.TYPE]).length)throw"RedSceneInfo : 직사광 최대갯수는 5개입니다.";t.push(e)}else if(e instanceof RedPointLightInfo){if(16==(t=this.lights[RedPointLightInfo.TYPE]).length)throw"RedSceneInfo : 포인트라이트 최대갯수는 16개입니다.";t.push(e)}else{if(!(e instanceof RedAmbientLightInfo))throw"RedSceneInfo : 등록할수 없는 Light타입입니다.";(t=this.lights[RedAmbientLightInfo.TYPE])[0]=e}}}()},Object.freeze(RedSceneInfo)}();var RedBaseRenderInfo;!function(){var t;t=function(t){throw t},(RedBaseRenderInfo=function(e,n,r){if(!(this instanceof RedBaseRenderInfo))return new RedBaseRenderInfo(e,n,r);if(!(e instanceof RedGL))throw"RedBaseRenderInfo : RedGL 인스턴스만 허용됩니다.";var a;a=this,this.callback=r,this.targetScene=n,this.__UUID=REDGL_UUID++;var i,o,f,u,s,h,c,d,l,R,M,I,_,m,E,v,A,T=[];A={uDiffuseTexture:["uUseDiffuseTexture","uDiffuseTexture","PASS"],uNormalTexture:["uUseNormalTexture","uNormalTexture","NORMAL"],uDisplacementTexture:["uUseDisplacementTexture","uDisplacementTexture","DISPLACEMENT"],uSpecularTexture:["uUseSpecularTexture","uSpecularTexture","SPECULAR"],uEtcVertextTexture1:["uUseEtcVertexTexture1","uEtcVertextTexture1","ETC_VERTEX_1"],uEtcVertextTexture2:["uUseEtcVertexTexture2","uEtcVertextTexture2","ETC_VERTEX_2"],uEtcFragmentTexture1:["uUseEtcFragmentTexture1","uEtcFragmentTexture1","ETC_FRAGMENT_1"],uEtcFragmentTexture2:["uUseEtcFragmentTexture2","uEtcFragmentTexture2","ETC_FRAGMENT_2"],uReflectionTexture:["uUseReflectionTexture","uReflectionTexture","CUBE_REFLECTION"],uRefractionTexture:["uUseRefractionTexture","uRefractionTexture","CUBE_REFRACTION"]},s=new Uint32Array(1e6),h=new Uint32Array(1e6),c=new Uint32Array(1e6),d=new Float64Array(1e6),l=new Uint32Array(1e6),this.render=function(){var t,n,r,s,h,c,d,l,M,I,_,m,E,v,A,b,g;return d=new Float32Array(4),_=new Float32Array(48),m=new Float32Array(64),v=new Float32Array(48),A=new Float32Array(64),b=new Float32Array(16),s=new Float32Array(2),function(p){R=void 0,a.callback&&a.callback(p),a.numDrawCall=0,f=e.gl,e.setSize(),(o=a.targetScene).camera.update(),r=p/1e3,s[0]=f.drawingBufferWidth,s[1]=f.drawingBufferHeight;for(i in e.__datas.RedProgramInfo){if(t=e.__datas.RedProgramInfo[i],n=t.uniforms,f.useProgram(t.program),u=t.program,f.uniformMatrix4fv(n.uPMatrix.location,!1,o.camera.uPMatrix),f.uniformMatrix4fv(n.uCameraMatrix.location,!1,o.camera.uCameraMatrix),n.uCameraPosition&&f.uniform3fv(n.uCameraPosition.location,o.camera.__desiredCoords),c=o.lights[RedAmbientLightInfo.TYPE][0],n.uAmbientLightColor&&c&&(h=c.color,d[0]=h[0],d[1]=h[1],d[2]=h[2],d[3]=h[3],f.uniform4fv(n.uAmbientLightColor.location,d)),I=o.lights[RedDirectionalLightInfo.TYPE],M=l=I.length,n=t.uniforms,M&&n.uDirectionnalLightDirection){for(;l--;)c=I[l],E=c.direction,h=c.color,_[3*l+0]=E[0],_[3*l+1]=E[1],_[3*l+2]=E[2],m[4*l+0]=h[0],m[4*l+1]=h[1],m[4*l+2]=h[2],m[4*l+3]=h[3];f.uniform3fv(n.uDirectionnalLightDirection.location,_),f.uniform4fv(n.uDirectionnalLightColor.location,m),f.uniform1i(n.uDirectionalNum.location,M)}if(I=o.lights[RedPointLightInfo.TYPE],M=l=I.length,n=t.uniforms,M&&n.uPointNum){for(T.length=0;l--;)c=I[l],g=c.position,h=c.color,v[3*l+0]=g[0],v[3*l+1]=g[1],v[3*l+2]=g[2],A[4*l+0]=h[0],A[4*l+1]=h[1],A[4*l+2]=h[2],A[4*l+3]=h[3],b[l]=c.radius,c.useDebugMode&&(T.push(c.__debugMesh),c.__debugMesh.position[0]=g[0],c.__debugMesh.position[1]=g[1],c.__debugMesh.position[2]=g[2],c.__debugMesh.scale[0]=c.__debugMesh.scale[1]=c.__debugMesh.scale[2]=2*c.radius,c.__debugMesh.materialInfo.uColor[0]=h[0],c.__debugMesh.materialInfo.uColor[1]=h[1],c.__debugMesh.materialInfo.uColor[2]=h[2],c.__debugMesh.materialInfo.uColor[3]=.5);f.uniform3fv(n.uPointLightPosition.location,v),f.uniform4fv(n.uPointLightColor.location,A),f.uniform1i(n.uPointNum.location,M),f.uniform1fv(n.uPointLightRadius.location,b)}n.uSystemTime&&f.uniform1f(n.uSystemTime.location,r),n.uSystemResolution&&f.uniform2fv(n.uSystemResolution.location,s)}f.clear(f.COLOR_BUFFER_BIT),a.drawSkyBox(o.skyBox,p),f.clear(f.DEPTH_BUFFER_BIT),a.draw(o.children,p),a.draw(T),a.drawGrid(o.grid,p),requestAnimationFrame(a.render)}}(),this.drawGrid=function(){var t=[];return function(e){e&&(t.length=0,t.push(e),a.draw(t))}}(),this.drawSkyBox=function(){var t=[];return function(e){e&&(e.scale[0]=e.scale[1]=e.scale[2]=o.camera.far,t.length=0,t.push(e),a.draw(t))}}(),this.draw=function(e,n,r){var i,o,T,b,g,p,x,w,y,U,S,L,P,D,N,B,F,G,C,O,Y,j,V,X,z,k,q,Z,H,W,Q,J,K,$,tt,et,nt,rt,at,it,ot,ft,ut,st,ht,ct,dt,lt,Rt,Mt,It,_t,mt,Et,vt,At,Tt,bt,gt,pt,xt,wt,yt,Ut,St,Lt,Pt,Dt,Nt,Bt,Ft,Gt,Ct,Ot,Yt,jt,Vt,Xt,zt,kt,qt,Zt,Ht,Wt,Qt,Jt,Kt,$t,te,ee,ne,re,ae,ie,oe,fe,ue,se,he,ce,de,le,Re,Me,Ie,_e,me,Ee,ve,Ae,Te,be,ge,pe,xe,we,ye,Ue,Se,Le,Pe,De,Ne,Be,Fe,Ge,Ce,Oe,Ye;for(Fe=3.141592653589793,Ge=6.283185307179586,.225,Ce=1.27323954,Oe=.405284735,Ye=1.5707963267948966,ve=RedTextureIndex.PASS,ye=RedConst.INT,Ue=RedConst.FLOAT,Se=RedConst.VEC,Le=RedConst.MAT,Pe=RedConst.SAMPLER,De=RedConst.ATLASCOORD,Ne=a,Ie=A,Te=(Ae=f).ARRAY_BUFFER,be=Ae.ELEMENT_ARRAY_BUFFER,ge=Ae.UNSIGNED_SHORT,pe=Ae.TEXTURE0,xe=Ae.TEXTURE_2D,we=Ae.TEXTURE_CUBE_MAP,Math.sin,Math.cos,i=e.length;i--;){for(Ne.numDrawCall++,V=(j=e[i]).uMVMatrix,X=j.uNMatrix,z=j.position,k=j.rotation,q=j.scale,V[0]=1,V[1]=0,V[2]=0,V[3]=0,V[4]=0,V[5]=1,V[6]=0,V[7]=0,V[8]=0,V[9]=0,V[10]=1,V[11]=0,V[12]=0,V[13]=0,V[14]=0,V[15]=1,$=V,Ct=z[0],Ot=z[1],Yt=z[2],$[12]=$[0]*Ct+$[4]*Ot+$[8]*Yt+$[12],$[13]=$[1]*Ct+$[5]*Ot+$[9]*Yt+$[13],$[14]=$[2]*Ct+$[6]*Ot+$[10]*Yt+$[14],$[15]=$[3]*Ct+$[7]*Ot+$[11]*Yt+$[15],ot=k[0],ft=k[1],ut=k[2],(Be=ot%Ge)<-Fe?Be+=Ge:Be>Fe&&(Be-=Ge),tt=(Be=Be<0?Ce*Be+Oe*Be*Be:Ce*Be-Oe*Be*Be)<0?.225*(Be*-Be-Be)+Be:.225*(Be*Be-Be)+Be,(Be=(ot+Ye)%Ge)<-Fe?Be+=Ge:Be>Fe&&(Be-=Ge),rt=(Be=Be<0?Ce*Be+Oe*Be*Be:Ce*Be-Oe*Be*Be)<0?.225*(Be*-Be-Be)+Be:.225*(Be*Be-Be)+Be,(Be=ft%Ge)<-Fe?Be+=Ge:Be>Fe&&(Be-=Ge),et=(Be=Be<0?Ce*Be+Oe*Be*Be:Ce*Be-Oe*Be*Be)<0?.225*(Be*-Be-Be)+Be:.225*(Be*Be-Be)+Be,(Be=(ft+Ye)%Ge)<-Fe?Be+=Ge:Be>Fe&&(Be-=Ge),at=(Be=Be<0?Ce*Be+Oe*Be*Be:Ce*Be-Oe*Be*Be)<0?.225*(Be*-Be-Be)+Be:.225*(Be*Be-Be)+Be,(Be=ut%Ge)<-Fe?Be+=Ge:Be>Fe&&(Be-=Ge),nt=(Be=Be<0?Ce*Be+Oe*Be*Be:Ce*Be-Oe*Be*Be)<0?.225*(Be*-Be-Be)+Be:.225*(Be*Be-Be)+Be,(Be=(ut+Ye)%Ge)<-Fe?Be+=Ge:Be>Fe&&(Be-=Ge),it=(Be=Be<0?Ce*Be+Oe*Be*Be:Ce*Be-Oe*Be*Be)<0?.225*(Be*-Be-Be)+Be:.225*(Be*Be-Be)+Be,st=$[0],ht=$[1],ct=$[2],lt=$[4],Rt=$[5],Mt=$[6],_t=$[8],mt=$[9],Et=$[10],Ut=at*it,St=tt*et*it-rt*nt,Lt=rt*et*it+tt*nt,Pt=at*nt,Dt=tt*et*nt+rt*it,Nt=rt*et*nt-tt*it,Bt=-et,Ft=tt*at,Gt=rt*at,$[0]=st*Ut+lt*St+_t*Lt,$[1]=ht*Ut+Rt*St+mt*Lt,$[2]=ct*Ut+Mt*St+Et*Lt,$[4]=st*Pt+lt*Dt+_t*Nt,$[5]=ht*Pt+Rt*Dt+mt*Nt,$[6]=ct*Pt+Mt*Dt+Et*Nt,$[8]=st*Bt+lt*Ft+_t*Gt,$[9]=ht*Bt+Rt*Ft+mt*Gt,$[10]=ct*Bt+Mt*Ft+Et*Gt,Ct=q[0],Ot=q[1],Yt=q[2],$[0]=$[0]*Ct,$[1]=$[1]*Ct,$[2]=$[2]*Ct,$[3]=$[3]*Ct,$[4]=$[4]*Ot,$[5]=$[5]*Ot,$[6]=$[6]*Ot,$[7]=$[7]*Ot,$[8]=$[8]*Yt,$[9]=$[9]*Yt,$[10]=$[10]*Yt,$[11]=$[11]*Yt,$[12]=$[12],$[13]=$[13],$[14]=$[14],$[15]=$[15],r&&(st=r[0],ht=r[1],ct=r[2],dt=r[3],lt=r[4],Rt=r[5],Mt=r[6],It=r[7],_t=r[8],mt=r[9],Et=r[10],vt=r[11],At=r[12],Tt=r[13],bt=r[14],gt=r[15],pt=V[0],xt=V[1],wt=V[2],yt=V[3],V[0]=pt*st+xt*lt+wt*_t+yt*At,V[1]=pt*ht+xt*Rt+wt*mt+yt*Tt,V[2]=pt*ct+xt*Mt+wt*Et+yt*bt,V[3]=pt*dt+xt*It+wt*vt+yt*gt,pt=V[4],xt=V[5],wt=V[6],yt=V[7],V[4]=pt*st+xt*lt+wt*_t+yt*At,V[5]=pt*ht+xt*Rt+wt*mt+yt*Tt,V[6]=pt*ct+xt*Mt+wt*Et+yt*bt,V[7]=pt*dt+xt*It+wt*vt+yt*gt,pt=V[8],xt=V[9],wt=V[10],yt=V[11],V[8]=pt*st+xt*lt+wt*_t+yt*At,V[9]=pt*ht+xt*Rt+wt*mt+yt*Tt,V[10]=pt*ct+xt*Mt+wt*Et+yt*bt,V[11]=pt*dt+xt*It+wt*vt+yt*gt,pt=V[12],xt=V[13],wt=V[14],yt=V[15],V[12]=pt*st+xt*lt+wt*_t+yt*At,V[13]=pt*ht+xt*Rt+wt*mt+yt*Tt,V[14]=pt*ct+xt*Mt+wt*Et+yt*bt,V[15]=pt*dt+xt*It+wt*vt+yt*gt),p=(g=(b=j.materialInfo).programInfo).program,w=(x=j.geometryInfo).attributes,y=x.__attributeList,U=g.attributes,D=g.uniforms,C=x.indices,O=w.vertexPosition,u!=p&&Ae.useProgram(p),H=s,W=h,J=c,Q=d,K=l,u=p,o=y.length;o--;)U[L=(S=y[o]).shaderPointerKey]&&(F=U[L].location,H[F]==S.__UUID||(Ae.bindBuffer(Te,S.buffer),S.enabled||(Ae.enableVertexAttribArray(F),S.enabled=1),Ae.vertexAttribPointer(F,S.pointSize,S.glArrayType,S.normalize,S.stride,S.offset),H[F]=S.__UUID));for(b.needUniformList&&b.updateUniformList(),o=(P=b.__uniformList).length,Z=1;o--;)B=b[N=(T=P[o]).key],G=(F=T.location).__UUID,(Y=P[o].renderType)==Pe?(_e=Ie[N],B&&B.__webglTextureYn?(B.__webglAtlasTexture&&(B=B.parentAtlasInfo.textureInfo),B.loaded?(W[me=B.__targetIndex]!=B.__UUID&&(Ae.activeTexture(pe+me),Ae.bindTexture(B.__webglTexture?xe:we,B.texture),Ae.uniform1i(F,me),W[me]=B.__UUID),_e&&((Ee=RedTextureIndex[Ie[N][2]])!=ve&&me!=Ee&&t(Ie[N][2]+" 인덱스타입이 아닙니다."),1==J[G]||Ae.uniform1i(D[_e[0]].location,J[G]=1))):Z=0):_e&&(0==J[G]||Ae.uniform1i(D[_e[0]].location,J[G]=0)),B&&!B.__webglTextureYn&&t("RedBaseRenderInfo : "+N+" - sampler에 sampler형식이 아닌 값이 들어옵니다.")):Y==ye?Q[G]==B||Ae.uniform1i(F,Q[G]=B):Y==Ue?Q[G]==B||Ae.uniform1f(F,Q[G]=B):Y==Se?Ae[B.__uniformMethod](F,B):Y==Le?Ae[B.__uniformMethod](F,!1,B):Y==De?(K[G]==B.__UUID||Ae.uniform4fv(F,B.value),K[G]=B.__UUID):t(N+" 안되는 나쁜 타입인거야!!");D.uNMatrix&&(jt=V[0],Vt=V[1],Xt=V[2],zt=V[3],kt=V[4],qt=V[5],Zt=V[6],Ht=V[7],Wt=V[8],Qt=V[9],Jt=V[10],Kt=V[11],te=V[12],ee=V[13],ne=V[14],re=V[15],$t=jt*qt-Vt*kt,ae=jt*Zt-Xt*kt,ie=jt*Ht-zt*kt,oe=Vt*Zt-Xt*qt,fe=Vt*Ht-zt*qt,ue=Xt*Ht-zt*Zt,se=Wt*ee-Qt*te,he=Wt*ne-Jt*te,ce=Wt*re-Kt*te,de=Qt*ne-Jt*ee,le=Qt*re-Kt*ee,Re=Jt*re-Kt*ne,Me=$t*Re-ae*le+ie*de+oe*ce-fe*he+ue*se,Me=1/Me,X[0]=(qt*Re-Zt*le+Ht*de)*Me,X[1]=(-Vt*Re+Xt*le-zt*de)*Me,X[2]=(ee*ue-ne*fe+re*oe)*Me,X[3]=(-Qt*ue+Jt*fe-Kt*oe)*Me,X[4]=(-kt*Re+Zt*ce-Ht*he)*Me,X[5]=(jt*Re-Xt*ce+zt*he)*Me,X[6]=(-te*ue+ne*ie-re*ae)*Me,X[7]=(Wt*ue-Jt*ie+Kt*ae)*Me,X[8]=(kt*le-qt*ce+Ht*se)*Me,X[9]=(-jt*le+Vt*ce-zt*se)*Me,X[10]=(te*fe-ee*ie+re*$t)*Me,X[11]=(-Wt*fe+Qt*ie-Kt*$t)*Me,X[12]=(-kt*de+qt*he-Zt*se)*Me,X[13]=(jt*de-Vt*he+Xt*se)*Me,X[14]=(-te*oe+ee*ae-ne*$t)*Me,X[15]=(Wt*oe-Qt*ae+Jt*$t)*Me,ht=X[1],ct=X[2],dt=X[3],Mt=X[6],It=X[7],vt=X[11],X[1]=X[4],X[2]=X[8],X[3]=X[12],X[4]=ht,X[6]=X[9],X[7]=X[13],X[8]=ct,X[9]=Mt,X[11]=X[14],X[12]=dt,X[13]=It,X[14]=vt,Ae.uniformMatrix4fv(D.uNMatrix.location,!1,X)),Ae.uniformMatrix4fv(D.uMVMatrix.location,!1,V),M!=j.useCullFace&&((M=j.useCullFace)?Ae.enable(Ae.CULL_FACE):Ae.disable(Ae.CULL_FACE)),I!=j.cullFace&&Ae.cullFace(I=j.cullFace),E!=j.useDepthTest&&((E=j.useDepthTest)?Ae.enable(Ae.DEPTH_TEST):Ae.disable(Ae.DEPTH_TEST)),v!=j.depthTestFunc&&Ae.depthFunc(v=j.depthTestFunc),_!=j.useBlendMode&&((_=j.useBlendMode)?Ae.enable(Ae.BLEND):Ae.disable(Ae.BLEND)),m!=j.blendFactor1+j.blendFactor2&&(Ae.blendFunc(j.blendFactor1,j.blendFactor2),m=j.blendFactor1+j.blendFactor2),C?Z&&(R==C.__UUID||Ae.bindBuffer(be,C.buffer),Ae.drawElements(j.drawMode,C.pointNum,ge,0),R=C.__UUID):(Ae.drawArrays(j.drawMode,0,O.pointNum),R=O.__UUID),j.children.length&&Ne.draw(j.children,n,V)}}}).prototype={start:function(){return requestAnimationFrame(this.render),this},pause:function(){return this},resume:function(){return this},numDrawCall:0},Object.freeze(RedBaseRenderInfo)}();var redGLDetect;!function(){var t,e,n,r,a,i;redGLDetect=function(o){if(!(this instanceof redGLDetect))return new redGLDetect(o);if(!(o instanceof RedGL))throw"RedGL 인스턴스만 허용됩니다.";for(i=o.gl,t="VENDOR,VERSION,SHADING_LANGUAGE_VERSION,RENDERER,MAX_VERTEX_ATTRIBS,MAX_VARYING_VECTORS,MAX_VERTEX_UNIFORM_VECTORS,MAX_VERTEX_TEXTURE_IMAGE_UNITS,MAX_FRAGMENT_UNIFORM_VECTORS,MAX_TEXTURE_SIZE,MAX_CUBE_MAP_TEXTURE_SIZE,MAX_COMBINED_TEXTURE_IMAGE_UNITS,MAX_TEXTURE_IMAGE_UNITS,MAX_RENDERBUFFER_SIZE,MAX_VIEWPORT_DIMS,RED_BITS,GREEN_BITS,BLUE_BITS,ALPHA_BITS,DEPTH_BITS,STENCIL_BITS".split(","),e=/[_]\S/g,n=function(t){return t.charAt(1).toUpperCase()},r=t.length;r--;)this[a=t[r]]=i.getParameter(i[a])}}();var RedConst;RedConst={INT:1,FLOAT:2,VEC:3,MAT:4,SAMPLER:5,ATLASCOORD:6},Object.freeze(RedConst);var RedShaderLoader;!function(){var t;t=function(t,e){var n,r;for(n in e)r=e[n],t.createShaderInfo(r.name,RedShaderInfo.VERTEX_SHADER,t.getSourceFromScript(r.shaderInfo.vs.id)),t.createShaderInfo(r.name,RedShaderInfo.FRAGMENT_SHADER,t.getSourceFromScript(r.shaderInfo.fs.id)),t.createProgramInfo(r.name,t.getShaderInfo(r.name,RedShaderInfo.VERTEX_SHADER),t.getShaderInfo(r.name,RedShaderInfo.FRAGMENT_SHADER),r.onInitUniformValue,r.onDefineTexture),t.createMaterialDefine(t.getProgramInfo(r.name))},RedShaderLoader=function(e,n,r){if(!(this instanceof RedShaderLoader))return new RedShaderLoader(e,n,r);var a=0,i=[];for(var o in n)i.push(n[o].shaderInfo.vs),i.push(n[o].shaderInfo.fs);i.callback=r,i.forEach(function(r,o){var f=new XMLHttpRequest;f.open("GET",r.src,!0),f.onreadystatechange=function(){var o;4==f.readyState&&200==f.status&&((o=document.createElement("script")).setAttribute("id",r.id),o.setAttribute("type","glsl"),o.text=f.responseText,document.body.appendChild(o),++a==i.length&&setTimeout(function(){t(e,n),i.callback&&i.callback()},1))},f.send(null)})}}();var RedGL,REDGL_UUID;!function(){var t,e=[];REDGL_UUID=0,t=function(){var t,e,n,r;return e={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},t="webkit-3d,moz-webgl,3d,experimental-webgl,webgl,webgl2".split(","),function(a){for(r=t.length;r--;)if(n=a.getContext(t[r],e))return n.mode=t[r],n;throw"RedGL : 웹지엘을 사용할수없습니다."}}(),RedGL=function(n,r,a,i){if(!(this instanceof RedGL))return new RedGL(n,r,a,i);var o;this.__canvas=n,n.style.boxSizing="border-box",this.gl=o=t(n),a&&this.setSize(),this.fullMode=a,this.__UUID=REDGL_UUID++,this.__datas={},this.detect=redGLDetect(this),this.renderScale=1,o.enable(o.DEPTH_TEST),o.depthFunc(o.LESS),o.frontFace(o.CCW),o.enable(o.CULL_FACE),o.cullFace(o.BACK),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),o.enable(o.SCISSOR_TEST),o.scissor(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),e.push(this),this.createTextureInfo("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",0),i?RedShaderLoader(this,i,r):r&&r()},window.addEventListener("resize",function(){e.forEach(function(t){t.fullMode&&t.setSize()})}),RedGL.prototype={setRenderScale:function(t){this.renderScale=t,e.forEach(function(t){t.fullMode&&t.setSize(void 0,void 0,!0)})},setSize:function(){var t,e,n,r,a,i;return r=0,a=0,function(o,f,u){e=o||(document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),n=f||(document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),n=f||window.innerHeight,t=this.gl,i=window.devicePixelRatio||1,this.renderScale=this.renderScale?this.renderScale:1,(r!=e||a!=n||u)&&(this.__canvas.width=e*i*this.renderScale,this.__canvas.height=n*i*this.renderScale,this.__canvas.style.width=e,this.__canvas.style.height=n,t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.scissor(0,0,t.drawingBufferWidth,t.drawingBufferHeight),r=e,a=n)}}(),getSourceFromScript:RedShaderInfo.getSourceFromScript,createShaderInfo:function(t,e,n){return new RedShaderInfo(this,t,e,n)},getShaderInfo:function(t,e){return this.__datas.shaderInfo[e][t]},createProgramInfo:function(t,e,n,r,a){return new RedProgramInfo(this,t,e,n,r,a)},getProgramInfo:function(t){return this.__datas.RedProgramInfo[t]},createArrayBufferInfo:function(t,e,n,r,a,i,o,f,u,s){return new RedBufferInfo(this,RedBufferInfo.ARRAY_BUFFER,t,e,n,r,a,i,o,f,u,s)},createIndexBufferInfo:function(t,e,n,r,a,i,o,f,u){return new RedBufferInfo(this,RedBufferInfo.ELEMENT_ARRAY_BUFFER,t,null,e,n,r,a,i,o,f,u)},getArrayBufferInfo:function(t){return this.__datas.RedBufferInfo[t]},getIndexBufferInfo:function(t){return this.__datas.RedBufferInfo[t]},createGeometryInfo:function(t,e,n,r,a){return new RedGeometryInfo(this,t,e,n,r,a)},getGeometryInfo:function(t){return this.__datas.RedGeometryInfo[t]},createMaterialDefine:function(t){return new RedMaterialDefine(this,t)},createMaterialInfo:function(t,e,n,r,a,i,o){return new RedMaterialInfo(this,t,e,n,r,a,i,o)},createTextureInfo:function(t,e,n,r,a,i){return new RedTextureInfo(this,t,e,n,r,a,i)},createCubeTextureInfo:function(t){return new RedCubeTextureInfo(this,t)},createMeshInfo:function(t,e,n){return new RedMeshInfo(this,t,e,n)},getMeshInfo:function(t){return this.__datas.RedMeshInfo[t]},createSceneInfo:function(t,e){return new RedSceneInfo(this,t,e)},createAmbientLight:function(){return new RedAmbientLightInfo(this)},createDirectionalLight:function(){return new RedDirectionalLightInfo(this)},createPointLight:function(){return new RedPointLightInfo(this)},createSkyBoxInfo:function(t){return new RedSkyBoxInfo(this,t)},createBaseCameraInfo:function(t){return new RedBaseCameraInfo(this,t)},getBaseCameraInfo:function(t){return this.__datas.RedBaseCameraInfo[t]},createBaseRenderInfo:function(t,e){return new RedBaseRenderInfo(this,t,e)}}}();console.log('LOGIN Release. last update(2018-01-30 16:41:19)');