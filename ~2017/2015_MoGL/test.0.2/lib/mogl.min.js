var MoGL=function(){var e,t,r,i,n,a,s,o,l,h;return e={factory:1},t={superChain:1},a=0,o=0,s={},r={value:0},i={value:!0,writable:!0},n={value:null,writable:!0},l=function(){r.value=a++,Object.defineProperty(this,"uuid",r),Object.defineProperty(this,"isAlive",i),Object.defineProperty(this,"_id",n),o++},h=l.prototype,Object.defineProperty(h,"id",{get:function(){return this._id},set:function(e){this._id=e}}),Object.defineProperty(h,"destroy",{value:function(){var e;for(e in this)this.hasOwnProperty(e)&&(this[e]=null);this.isAlive=!1,s[this.constructor.uuid]--,o--}}),Object.defineProperty(h,"setId",{value:function(e){return this.id=e,this}}),Object.freeze(h),l.count=function(e){return"function"==typeof e?s[e.uuid]:o},l.error=function(e,t,r){throw new Error(e+"."+t+":"+r)},l.isAlive=function(e){if(!e.isAlive)throw new Error("Destroyed Object:"+e)},l.ext=function(r,i){var n,o,h,u;i===l||"uuid"in i||l.error("MoGL","ext",0),n=function(){var a,o=arguments[0];return o!==t?this instanceof n?(a=o===e?arguments[1]:arguments,i.call(this,t,a),r.apply(this,a),Object.seal(this),s[n.uuid]++,this):n.call(Object.create(n.prototype),e,arguments):(i.apply(this,arguments[1]),void r.apply(this,arguments[1]))},Object.defineProperty(n,"uuid",{value:a++}),n.uuid in s||(s[n.uuid]=0),h=Object.create(i.prototype),o=r.prototype;for(u in o)o.hasOwnProperty(u)&&(h[u]=o[u]);for(u in r)r.hasOwnProperty(u)&&(n[u]=r[u]);return n.prototype=h,Object.freeze(n),Object.seal(h),n},Object.freeze(l),l}(),BlendMode={add:"add",alpha:"alpha",darken:"darken",difference:"difference",erase:"erase",hardlight:"hardlight",invert:"invert",lighten:"lighten",multiply:"multiply",screen:"screen",subtract:"subtract"};Object.freeze(BlendMode);var Filter={anaglyph:"anaglyph",bevel:"bevel",bloom:"bloom",blur:"blur",colorMatrix:"colorMatrix",convolution:"convolution",displacementMap:"displacementMap",fxaa:"fxaa",glow:"glow",invert:"invert",mono:"mono",sepia:"sepia",shadow:"shadow"};Object.freeze(Filter);var Vertex={x:"x",y:"y",z:"z",r:"r",g:"g",b:"b",a:"a",normalX:"nx",normalY:"ny",normalZ:"nz",u:"u",v:"v"};Object.freeze(Vertex);var Shading={none:function(){this._shading.type="none"},gouraud:function(){this._shading.type="gouraud"},phong:function(){this._shading.type="phong"},blinn:function(){this._shading.type="blinn"},flat:function(){this._shading.type="flat"},toon:function(){this._shading.type="toon"}};Object.freeze(Shading);var VertexShader={baseFunction:"mat4 positionMTX(vec3 t){\n   return mat4( 1,0,0,0, 0,1,0,0, 0,0,1,0, t[0],t[1],t[2],1);\n}\nmat4 scaleMTX(vec3 t){\n   return mat4( t[0],0,0,0, 0,t[1],0,0, 0,0,t[2],0, 0,0,0,1);\n}\nmat4 rotationMTX(vec3 t){\n   float s = sin(t[0]);float c = cos(t[0]);\n   mat4 m1 = mat4( 1,0,0,0, 0,c,-s,0, 0,s,c,0, 0,0,0,1);s = sin(t[1]);c = cos(t[1]);\n   mat4 m2 = mat4(c,0,s,0, 0,1,0,0, -s,0,c,0, 0,0,0,1);s = sin(t[2]);c = cos(t[2]);\n   mat4 m3 = mat4(c,-s,0,0, s,c,0,0, 0,0,1,0, 0,0,0,1);\n   return m3*m2*m1;\n}\n"};Object.freeze(VertexShader);var GLMAT_EPSILON=1e-6,Matrix=function(){var e={};return e.create=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.clone=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],l=t[6],h=t[7],u=t[8],c=t[9],_=t[10],m=t[11],v=t[12],d=t[13],g=t[14],f=t[15],M=r*o-i*s,x=r*l-n*s,p=r*h-a*s,A=i*l-n*o,L=i*h-a*o,R=n*h-a*l,b=u*d-c*v,y=u*g-_*v,E=u*f-m*v,G=c*g-_*d,T=c*f-m*d,P=_*f-m*g,F=M*P-x*T+p*G+A*E-L*y+R*b;return F?(F=1/F,e[0]=(o*P-l*T+h*G)*F,e[1]=(n*T-i*P-a*G)*F,e[2]=(d*R-g*L+f*A)*F,e[3]=(_*L-c*R-m*A)*F,e[4]=(l*E-s*P-h*y)*F,e[5]=(r*P-n*E+a*y)*F,e[6]=(g*p-v*R-f*x)*F,e[7]=(u*R-_*p+m*x)*F,e[8]=(s*T-o*E+h*b)*F,e[9]=(i*E-r*T-a*b)*F,e[10]=(v*L-d*p+f*M)*F,e[11]=(c*p-u*L-m*M)*F,e[12]=(o*y-s*G-l*b)*F,e[13]=(r*G-i*y+n*b)*F,e[14]=(d*x-v*A-g*M)*F,e[15]=(u*A-c*x+_*M)*F,e):null},e.multiply=function(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],h=t[6],u=t[7],c=t[8],_=t[9],m=t[10],v=t[11],d=t[12],g=t[13],f=t[14],M=t[15],x=r[0],p=r[1],A=r[2],L=r[3];return e[0]=x*i+p*o+A*c+L*d,e[1]=x*n+p*l+A*_+L*g,e[2]=x*a+p*h+A*m+L*f,e[3]=x*s+p*u+A*v+L*M,x=r[4],p=r[5],A=r[6],L=r[7],e[4]=x*i+p*o+A*c+L*d,e[5]=x*n+p*l+A*_+L*g,e[6]=x*a+p*h+A*m+L*f,e[7]=x*s+p*u+A*v+L*M,x=r[8],p=r[9],A=r[10],L=r[11],e[8]=x*i+p*o+A*c+L*d,e[9]=x*n+p*l+A*_+L*g,e[10]=x*a+p*h+A*m+L*f,e[11]=x*s+p*u+A*v+L*M,x=r[12],p=r[13],A=r[14],L=r[15],e[12]=x*i+p*o+A*c+L*d,e[13]=x*n+p*l+A*_+L*g,e[14]=x*a+p*h+A*m+L*f,e[15]=x*s+p*u+A*v+L*M,e},e.mul=e.multiply,e.translate=function(e,t,r){var i,n,a,s,o,l,h,u,c,_,m,v,d=r[0],g=r[1],f=r[2];return t===e?(e[12]=t[0]*d+t[4]*g+t[8]*f+t[12],e[13]=t[1]*d+t[5]*g+t[9]*f+t[13],e[14]=t[2]*d+t[6]*g+t[10]*f+t[14],e[15]=t[3]*d+t[7]*g+t[11]*f+t[15]):(i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],h=t[6],u=t[7],c=t[8],_=t[9],m=t[10],v=t[11],e[0]=i,e[1]=n,e[2]=a,e[3]=s,e[4]=o,e[5]=l,e[6]=h,e[7]=u,e[8]=c,e[9]=_,e[10]=m,e[11]=v,e[12]=i*d+o*g+c*f+t[12],e[13]=n*d+l*g+_*f+t[13],e[14]=a*d+h*g+m*f+t[14],e[15]=s*d+u*g+v*f+t[15]),e},e.scale=function(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.rotate=function(e,t,r,i){var n,a,s,o,l,h,u,c,_,m,v,d,g,f,M,x,p,A,L,R,b,y,E,G,T=i[0],P=i[1],F=i[2],S=Math.sqrt(T*T+P*P+F*F);return Math.abs(S)<GLMAT_EPSILON?null:(S=1/S,T*=S,P*=S,F*=S,n=Math.sin(r),a=Math.cos(r),s=1-a,o=t[0],l=t[1],h=t[2],u=t[3],c=t[4],_=t[5],m=t[6],v=t[7],d=t[8],g=t[9],f=t[10],M=t[11],x=T*T*s+a,p=P*T*s+F*n,A=F*T*s-P*n,L=T*P*s-F*n,R=P*P*s+a,b=F*P*s+T*n,y=T*F*s+P*n,E=P*F*s-T*n,G=F*F*s+a,e[0]=o*x+c*p+d*A,e[1]=l*x+_*p+g*A,e[2]=h*x+m*p+f*A,e[3]=u*x+v*p+M*A,e[4]=o*L+c*R+d*b,e[5]=l*L+_*R+g*b,e[6]=h*L+m*R+f*b,e[7]=u*L+v*R+M*b,e[8]=o*y+c*E+d*G,e[9]=l*y+_*E+g*G,e[10]=h*y+m*E+f*G,e[11]=u*y+v*E+M*G,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},e.rotateX=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],s=t[5],o=t[6],l=t[7],h=t[8],u=t[9],c=t[10],_=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+h*i,e[5]=s*n+u*i,e[6]=o*n+c*i,e[7]=l*n+_*i,e[8]=h*n-a*i,e[9]=u*n-s*i,e[10]=c*n-o*i,e[11]=_*n-l*i,e},e.rotateY=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],s=t[1],o=t[2],l=t[3],h=t[8],u=t[9],c=t[10],_=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-h*i,e[1]=s*n-u*i,e[2]=o*n-c*i,e[3]=l*n-_*i,e[8]=a*i+h*n,e[9]=s*i+u*n,e[10]=o*i+c*n,e[11]=l*i+_*n,e},e.rotateZ=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],s=t[1],o=t[2],l=t[3],h=t[4],u=t[5],c=t[6],_=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+h*i,e[1]=s*n+u*i,e[2]=o*n+c*i,e[3]=l*n+_*i,e[4]=h*n-a*i,e[5]=u*n-s*i,e[6]=c*n-o*i,e[7]=_*n-l*i,e},e._frustum=function(t,r,i,n,a,s,o){var l=r-t,h=n-i,u=s-a;return o||(o=e.create()),o[0]=2*a/l,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*a/h,o[6]=0,o[7]=0,o[8]=(r+t)/l,o[9]=(n+i)/h,o[10]=-(s+a)/u,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(s*a*2)/u,o[15]=0,o},e.perspective=function(t,r,i,n,a){return t=i*Math.tan(t*Math.PI/360),r=t*r,e._frustum(-r,r,-t,t,i,n,a)},e.lookAt=function(t,r,i,n){var a,s,o,l,h,u,c,_,m,v,d=r[0],g=r[1],f=r[2],M=n[0],x=n[1],p=n[2],A=i[0],L=i[1],R=i[2];return Math.abs(d-A)<GLMAT_EPSILON&&Math.abs(g-L)<GLMAT_EPSILON&&Math.abs(f-R)<GLMAT_EPSILON?e.identity(t):(c=d-A,_=g-L,m=f-R,v=1/Math.sqrt(c*c+_*_+m*m),c*=v,_*=v,m*=v,a=x*m-p*_,s=p*c-M*m,o=M*_-x*c,v=Math.sqrt(a*a+s*s+o*o),v?(v=1/v,a*=v,s*=v,o*=v):(a=0,s=0,o=0),l=_*o-m*s,h=m*a-c*o,u=c*s-_*a,v=Math.sqrt(l*l+h*h+u*u),v?(v=1/v,l*=v,h*=v,u*=v):(l=0,h=0,u=0),t[0]=a,t[1]=l,t[2]=c,t[3]=0,t[4]=s,t[5]=h,t[6]=_,t[7]=0,t[8]=o,t[9]=u,t[10]=m,t[11]=0,t[12]=-(a*d+s*g+o*f),t[13]=-(l*d+h*g+u*f),t[14]=-(c*d+_*g+m*f),t[15]=1,t)},e.str=function(e){return"Matrix("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},e}(),Geometry=function(){var e,t;e=function(e,t,i){var n,a,s,o,l=e instanceof Float32Array,h=t instanceof Uint16Array;if(Array.isArray(e)||l||MoGL.error("Geometry","constructor",0),Array.isArray(t)||h||MoGL.error("Geometry","constructor",1),i)for(n=i.length,e.length%n&&MoGL.error("Geometry","constructor",2);n--;)i[i[n]]=n;if(s=arguments[2]?arguments[2].length:3,this._vertexCount=e.length/s,this._triangleCount=t.length/3,this._vertexShaders={},this._position=[],this._normal=[],this._uv=[],this._color=[],this._volume=null,this._key=null,arguments[2]){for(n=0,a=e.length/s;a>n;n++)o=s*n,this._position.push(e[o+i.x],e[o+i.y],e[o+i.z]),i.nx?this._normal.push(e[o+i.nx],e[o+i.ny],e[o+i.nz]):0,i.u?this._uv.push(e[o+i.u],e[o+i.v]):0,i.r?this._color.push(e[o+i.r],e[o+i.g],e[o+i.b],e[o+i.a]):0;this._position=new Float32Array(this._position),this._uv=new Float32Array(this._uv),this._color=new Float32Array(this._color)}else this._position=l?e:new Float32Array(e);this._index=h?t:new Uint16Array(t),this._normal=new Float32Array(0==this._normal.length?r(this._position,this._index):this._normal)};var r=function(e,t){var r,i,n,a=0,s=1,o=2,l=Math.sqrt,h=[],u=[],c=[],_=[],m=[];for(r=0,n=e.length;n>r;r++)h[r]=0;for(r=0,n=t.length;n>r;r+=3)for(u=[],c=[],_=[],u[a]=e[3*t[r+1]+a]-e[3*t[r]+a],u[s]=e[3*t[r+1]+s]-e[3*t[r]+s],u[o]=e[3*t[r+1]+o]-e[3*t[r]+o],c[a]=e[3*t[r+2]+a]-e[3*t[r+1]+a],c[s]=e[3*t[r+2]+s]-e[3*t[r+1]+s],c[o]=e[3*t[r+2]+o]-e[3*t[r+1]+o],_[a]=u[s]*c[o]-u[o]*c[s],_[s]=u[o]*c[a]-u[a]*c[o],_[o]=u[a]*c[s]-u[s]*c[a],i=0;3>i;i++)h[3*t[r+i]+a]=h[3*t[r+i]+a]+_[a],h[3*t[r+i]+s]=h[3*t[r+i]+s]+_[s],h[3*t[r+i]+o]=h[3*t[r+i]+o]+_[o];for(var t=0,n=e.length;n>t;t+=3){m=[],m[a]=h[t+a],m[s]=h[t+s],m[o]=h[t+o];var n=l(m[a]*m[a]+m[s]*m[s]+m[o]*m[o]);0==n&&(n=1e-5),m[a]=m[a]/n,m[s]=m[s]/n,m[o]=m[o]/n,h[t+a]=m[a],h[t+s]=m[s],h[t+o]=m[o]}return h};return t=e.prototype,t.addVertexShader=function(e){return MoGL.isAlive(this),this._vertexShaders[e]=e,this},t.getVertexCount=function(){return MoGL.isAlive(this),this._vertexCount},t.getTriangleCount=function(){return MoGL.isAlive(this),this._triangleCount},t.getVolume=function(){if(MoGL.isAlive(this),!this._volume){for(var e,t,r,i=0,n=0,a=0,s=0,o=0,l=0,h=this._position,u=h.length;u--;)e=3*u,t=e+1,r=e+2,i=h[e]<i?h[e]:i,s=h[e]>s?h[e]:s,n=h[t]<n?h[t]:n,o=h[t]>o?h[t]:o,a=h[r]<a?h[r]:a,l=h[r]>l?h[r]:l;this._volume=[s-i,o-n,l-a]}return this._volume},t.removeVertexShader=function(e){return MoGL.isAlive(this),delete this._vertexShaders[e],this},MoGL.ext(e,MoGL)}(),Material=function(){var e,t,r,i;return r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,i=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i,e=function(){this._textures={},this._shading={type:"none",lambert:1},this._diffuse={__indexList:[]},this._normal={__indexList:[]},this._specular={__indexList:[]},this._diffuseWrap={__indexList:[]},this._specularNormal={__indexList:[]},this._r=1,this._rw=Math.random(),this._g=1,this._gw=Math.random(),this._b=1,this._bw=Math.random(),this._a=1,this._wireFrame=0,this._count=0,this._scene=null,this._key=null,this.setBackgroundColor.apply(this,arguments)},t=e.prototype,t.addTexture=function(e,t){MoGL.isAlive(this);var r=this._scene;r&&!r._textures[t]&&MoGL.error("Material","addTexture",0),this._textures[t]&&MoGL.error("Material","addTexture",1),this._textures[t]={id:t,type:e};var i;if(console.log("type :","_"+e),console.log("확인",this["_"+e],this["_"+e].__indexList.length),void 0!=arguments[2]){var n=arguments[2]>this["_"+e].__indexList.length?this["_"+e].__indexList.length:arguments[2];i=this["_"+e].__indexList.splice(n,0,{id:t,blendMode:arguments[3]})}else i=this["_"+e].__indexList.push({id:t,blendMode:arguments[3]});return this},t.getRefCount=function(){return MoGL.isAlive(this),this._count},t.removeTexture=function(e){MoGL.isAlive(this);var t=this._textures[e];if(!t)return this;for(var r=this._textures[e].type,i=this["_"+r].__indexList,n=i.length;n--;)if(i[n].id==e){i.splice(n,1);break}return delete this._textures[e],console.log("확인",this["_"+r]),this},t.setBackgroundColor=function(){MoGL.isAlive(this);var e,t,n=arguments[0];1==arguments.length?(n.length>7&&(t=+n.substr(7),n=n.substr(0,7)),"#"==n.charAt(0)&&((e=r.exec(n))?(this._r=parseInt(e[1],16)/255,this._g=parseInt(e[2],16)/255,this._b=parseInt(e[3],16)/255):(e=i.exec(n),this._r=parseInt(e[1]+e[1],16)/255,this._g=parseInt(e[2]+e[2],16)/255,this._b=parseInt(e[3]+e[3],16)/255),this._a=t?t>1?1:t:1)):(this._r=arguments[0]?arguments[0]:Math.random(),this._g=arguments[1]?arguments[1]:Math.random(),this._b=arguments[2]?arguments[2]:Math.random(),this._a=arguments[3]?arguments[3]:1)},t.setWireFrame=function(e){MoGL.isAlive(this),this._wireFrame=e;var t,n,a=arguments[1];2==arguments.length&&(a.length>7&&(n=+a.substr(7),a=a.substr(0,7)),(t=r.exec(a))?(this._rw=parseInt(t[1],16)/255,this._gw=parseInt(t[2],16)/255,this._bw=parseInt(t[3],16)/255):(t=i.exec(a),this._rw=parseInt(t[1]+t[1],16)/255,this._gw=parseInt(t[2]+t[2],16)/255,this._bw=parseInt(t[3]+t[3],16)/255))},t.setShading=function(e){MoGL.isAlive(this),e.apply(this)},t.setLambert=function(e){MoGL.isAlive(this),this._shading.lambert=e},MoGL.ext(e,MoGL)}(),Texture={zoomOut:"zoomOut",zoomIn:"zoomIn",crop:"crop",addSpace:"addSpace",diffuse:"diffuse",specular:"specular",diffuseWrap:"diffuseWrap",normal:"normal",specularNormal:"specularNormal"};Object.freeze(Texture);var Primitive=function(){var e=Math.sin,t=Math.cos,r=Math.PI,i=(Math.sqrt,Math.PI/180),n=(180/Math.PI,2*Math.PI),a=Math.PI/2;return{cube:function(){var e;return e},geodesic:function(){var s,o,l,h,u,c,_,m,v,d,g,f,M,x,p,A=1,L=5,R=!0,b=L+1,y=2*b,E=180/y*i,G=[],T=[];for(_=0,m=0,v=-A,R?G.push(_,-v,m,0,0):G.push(_,m,v,0,0),u=0;b>u;u++)for(s=4*(u+1),h=360/s*i,l=-a+(u+1)*E,p=(a+l)/r,d=e(l),g=t(l),v=A*d,c=0;s>=c;c++)o=c*h,f=e(o),M=t(o),_=A*g*M,m=A*g*f,x=o/n,R?G.push(_,-v,m,x,p):G.push(_,m,v,x,p);for(u=1;b>u;u++)for(s=4*(b-u),h=360/s*i,l=E*u,p=(a+l)/r,d=e(l),g=t(l),v=A*d,c=0;s>=c;c++)o=c*h,f=e(o),M=t(o),_=A*g*M,m=A*g*f,x=o/n,R?G.push(_,-v,m,x,p):G.push(_,m,v,x,p);_=0,m=0,v=A,R?G.push(_,-v,m,x,p):G.push(_,m,v,x,p);var P,F,S,V,O,C,B,U,I,D,w,X,N;for(X=1,O=0,C=0,u=0;b>u;++u){for(U=O,I=C,O+=4*u+1,C+=4*(u+1)+1,D=U,B=O,P=0;4>P;++P)for(w=1,N=0;X>N;++N)1===w?(F=D,V=B,B++,S=B,w=0):(F=B,S=D,D++,V=D,w=1),T.push(F,S,V);X+=2}for(u=b-1;u>=0;u--)for(U=O,I=C,O=O+4*(u+1)+1,C=C+4*u+1,X-=2,B=O,D=U,P=0;4>P;++P)for(w=0,N=0;X>N;N++)1===w?(F=D,V=B,B++,S=B,w=0):(F=B,S=D,D++,V=D,w=1),T.push(F,S,V);var Y=new Geometry(G,T,[Vertex.x,Vertex.y,Vertex.z,Vertex.u,Vertex.v]);return Y._key="geodesic"+(arguments[0]||1)+"_"+(arguments[1]||1),Y},line:function(e,t,r,i,n,a){var s;return s},plane:function(){var e,t;e=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],t=[0,1,2,1,2,3];var r=new Geometry(e,t,[Vertex.x,Vertex.y,Vertex.z]);return r._key="plane_"+(arguments[0]||1)+"_"+(arguments[1]||1),r},point:function(){var e;return e},sphere:function(){for(var r=[],i=[],n=8,a=8,s=1,o=0;n>=o;++o)for(var l=o*Math.PI/n,h=e(l),u=t(l),c=0;a>=c;++c){var _=2*c*Math.PI/a,m=e(_),v=t(_),d=v*h,g=u,f=m*h,M=1-c/a,x=1-o/n;r.push(s*d,s*g,s*f,M,x)}for(o=0;n>o;++o)for(c=0;a>c;++c){var p=o*(a+1)+c,A=p+a+1;i.push(A,p,p+1,A+1,A,p+1)}var L=new Geometry(r,i,[Vertex.x,Vertex.y,Vertex.z,Vertex.u,Vertex.v]);return L._key="sphere_"+(arguments[0]||1),L},skybox:function(){var e;return e},polygon:function(r,i){3>r&&MoGL.error("Primitive","polygon",0);var n,a=2*Math.PI/(r-1),s=[0,0,0,.5,.5],o=[];for(n=0;r>n;n++)s.push(e(a*n),t(a*n),0,-e(a*n)/2+.5,-t(a*n)/2+.5);for(n=0;r-1>n;n++)o.push(0,n+1,n+2);var l=new Geometry(s,o,[Vertex.x,Vertex.y,Vertex.z,Vertex.u,Vertex.v]);return l._key="polygon_"+(arguments[0]||1),l}}}(),Mesh=function(){{var e,t,r,i;Math.sqrt,Math.atan2,Math.asin,Math.cos,.5*Math.PI,180/Math.PI}return r=new Float32Array(3),i=new Float32Array(3),e=function(e,t){e&&!("string"==typeof e||e instanceof Geometry)&&MoGL.error("Mesh","contructor",0),t&&!("string"==typeof t||t instanceof Material)&&MoGL.error("Mesh","contructor",1),this._geometry=e,this._material=t,this._scene=null,this._parent=null,this._matrix=Matrix.create(),this.rotateX=0,this.rotateY=0,this.rotateZ=0,this.scaleX=1,this.scaleY=1,this.scaleZ=1,this.x=0,this.y=0,this.z=0},t=e.prototype,t.getGeometry=function(){return MoGL.isAlive(this),this._scene?this._geometry:null},t.getMaterial=function(){return MoGL.isAlive(this),this._scene?this._material:null},t.getMatrix=function(){return MoGL.isAlive(this),Matrix.identity(this._matrix),r[0]=this.scaleX,r[1]=this.scaleY,r[2]=this.scaleZ,Matrix.scale(this._matrix,this._matrix,r),Matrix.rotateX(this._matrix,this._matrix,this.rotateX),Matrix.rotateY(this._matrix,this._matrix,this.rotateY),Matrix.rotateZ(this._matrix,this._matrix,this.rotateZ),r[0]=this.x,r[1]=this.y,r[2]=this.z,Matrix.translate(this._matrix,this._matrix,r),this._matrix},t.getParent=function(){return MoGL.isAlive(this),this._parent?this._parent:null},t.getPosition=function(){return MoGL.isAlive(this),r[0]=this.x,r[1]=this.y,r[2]=this.z,r},t.getRotate=function(){return MoGL.isAlive(this),r[0]=this.rotateX,r[1]=this.rotateY,r[2]=this.rotateZ,r},t.getScale=function(){return MoGL.isAlive(this),r[0]=this.scaleX,r[1]=this.scaleY,r[2]=this.scaleZ,r},t.setGeometry=function(e){return MoGL.isAlive(this),e instanceof Geometry||"string"==typeof e||MoGL.error("Mesh","setGeometry",0),this._scene?(this._geometry=(this._geometry="string"==typeof e)?this._scene._geometrys[e]:e,this._geometry._key=this._geometry._key||e):this._geometry=e,this},t.setMaterial=function(e){return MoGL.isAlive(this),e instanceof Material||"string"==typeof e||MoGL.error("Mesh","setMaterial",0),this._scene?(this._material=(this._material="string"==typeof e)?this._scene._materials[e]:e,this._material._key=this._material._key||e):this._material=e,this},t.lookAt=function(e,t,n){MoGL.isAlive(this),Matrix.identity(this._matrix),r[0]=this.x,r[1]=this.y,r[2]=this.z,i[0]=e,i[1]=t,i[2]=n,Matrix.lookAt(this._matrix,r,i,[0,1,0]),Matrix.translate(this._matrix,this._matrix,r);var a,s,o,l=this._matrix,h=l[0],u=(l[1],l[2],l[4]),c=l[5],_=l[6],m=l[8],v=l[9],d=l[10],g=-m;s=-1>=g?.5*-Math.PI:g>=1?.5*Math.PI:Math.asin(g);var f=Math.cos(s);.001>=f?(o=0,a=Math.atan2(-_,c)):(o=Math.atan2(u,h),a=Math.atan2(v,d)),this.rotateX=a,this.rotateY=s,this.rotateZ=o},t.setPosition=function(){MoGL.isAlive(this);var e,t;return e=arguments.length,t=arguments[0],1==e&&t instanceof Array?(this.x=t[0],this.y=t[1],this.z=t[2]):e>2?(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2]):(this.x=0,this.y=0,this.z=0),this},t.setRotate=function(){MoGL.isAlive(this);var e,t;return e=arguments.length,t=arguments[0],1==e&&t instanceof Array?(this.rotateX=t[0],this.rotateY=t[1],this.rotateZ=t[2]):e>2?(this.rotateX=arguments[0],this.rotateY=arguments[1],this.rotateZ=arguments[2]):(this.rotateX=0,this.rotateY=0,this.rotateZ=0),this},t.setScale=function(){MoGL.isAlive(this);var e,t;return e=arguments.length,t=arguments[0],1==e&&t instanceof Array?(this.scaleX=t[0],this.scaleY=t[1],this.scaleZ=t[2]):e>2?(this.scaleX=arguments[0],this.scaleY=arguments[1],this.scaleZ=arguments[2]):(this.scaleX=1,this.scaleY=1,this.scaleZ=1),this},MoGL.ext(e,MoGL)}(),Group=function(){var e,t;return e=function(){this._children={},this._scene=null},t=e.prototype,t.addChild=function(e,t){MoGL.isAlive(this);var r,i;this._children[e]&&MoGL.error("Group","addChild",0),t instanceof Mesh||MoGL.error("Group","addChild",1),t._scene=this,t.setGeometry(t._geometry),t.setMaterial(t._material),i=t._geometry._vertexShaders;for(r in i)"string"==typeof i[r]&&(this._scene._vertexShaders[i[r]]||MoGL.error("Group","addChild",2));i=t._material._fragmentShaders;for(r in i)"string"==typeof i[r]&&(this._scene._fragmentShaders[i[r]]||MoGL.error("Group","addChild",3));i=t._material._textures;for(r in i)"string"==typeof i[r]&&(this._scene._textures[i[r]]||MoGL.error("Group","addChild",4));return this._children[e]=t,this},t.getChild=function(e){MoGL.isAlive(this);var t=this._children[e];return t?t:null},t.removeChild=function(e){return MoGL.isAlive(this),this._children[e]?(delete this._children[e],!0):!1},MoGL.ext(e,Mesh)}(),Camera=function(){var e,t,r,i,n,a,s;return r=[],n=Math.PI/180,i=new Float32Array(3),a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,s=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i,e=function(){this._cvs=null,this._renderArea=null,this._updateRenderArea=1,this._geometry=new Geometry([],[]),this._material=new Material,this._r=0,this._g=0,this._b=0,this._a=1,this._fov=55,this._near=.1,this._far=1e6,this._visible=1,this._filters={},this._fog=null,this._antialias=!1,this._pixelMatrix=Matrix.create(),this.z=-10,this._mode="3d",this.lookAt(0,0,0)},t=e.prototype,t.getMatrix=function(){return MoGL.isAlive(this),Matrix.identity(this._matrix),Matrix.rotateX(this._matrix,this._matrix,this.rotateX),Matrix.rotateY(this._matrix,this._matrix,this.rotateY),Matrix.rotateZ(this._matrix,this._matrix,this.rotateZ),i[0]=this.x,i[1]=this.y,i[2]=-this.z,Matrix.translate(this._matrix,this._matrix,i),this._matrix},t.getBackgroundColor=function(){return MoGL.isAlive(this),r[0]=this._r,r[1]=this._g,r[2]=this._b,r[3]=this._a,r},t.getClipPlane=function(){return MoGL.isAlive(this),[this._near,this._far]},t.getFilters=function(){MoGL.isAlive(this);var e=[],t=this._filters;for(var r in t)e.push(r);return e},t.getFog=function(){return MoGL.isAlive(this),this._fog?!0:!1},t.getFOV=function(){return MoGL.isAlive(this),this._fov},t.getProjectionMatrix=function(){return MoGL.isAlive(this),Matrix.identity(this._pixelMatrix),"2d"==this._mode?this._pixelMatrix=[2/this._renderArea[2],0,0,0,0,-2/this._renderArea[3],0,0,0,0,0,0,-1,1,0,1]:Matrix.perspective(this._fov,this._renderArea[2]/this._renderArea[3],this._near,this._far,this._pixelMatrix),this._pixelMatrix},t.getRenderArea=function(){return MoGL.isAlive(this),this._renderArea},t.getAntialias=function(){return MoGL.isAlive(this),this._antialias?!0:!1},t.getVisible=function(){return MoGL.isAlive(this),this._visible?!0:!1},t.setBackgroundColor=function(){MoGL.isAlive(this);var e,t,r;return e=arguments[0],1==arguments.length?(e.length>7&&(r=+e.substr(7),e=e.substr(0,7)),"#"==e.charAt(0)&&((t=a.exec(e))?(this._r=parseInt(t[1],16)/255,this._g=parseInt(t[2],16)/255,this._b=parseInt(t[3],16)/255):(t=s.exec(e),this._r=parseInt(t[1]+t[1],16)/255,this._g=parseInt(t[2]+t[2],16)/255,this._b=parseInt(t[3]+t[3],16)/255),this._a=r?r>1?1:r:1)):(this._r=arguments[0],this._g=arguments[1],this._b=arguments[2],this._a=arguments[3]?arguments[3]:1),this},t.setClipPlane=function(e,t){return MoGL.isAlive(this),this._near=e,this._far=t,this},t.setFog=function(e,t,r){MoGL.isAlive(this);var i,n,o=e;return 0!=o&&"#"==o.charAt(0)?(n={},(i=a.exec(o))?(n.r=parseInt(i[1],16)/255,n.g=parseInt(i[2],16)/255,n.b=parseInt(i[3],16)/255):(i=s.exec(o),n.r=parseInt(i[1]+i[1],16)/255,n.g=parseInt(i[2]+i[2],16)/255,n.b=parseInt(i[3]+i[3],16)/255),n.a=1,n.near=t,n.far=r,this._fog=n):o||(this._fog=null),this},t.setFOV=function(){return MoGL.isAlive(this),this._fov=1==arguments.length?arguments[0]:Math.ceil(2*Math.atan(Math.tan(arguments[2]*n/2)*(arguments[1]/arguments[0]))*(180/Math.PI)),this},t.setOthogonal=function(){return MoGL.isAlive(this),this._mode="2d",this},t.setPerspective=function(){return MoGL.isAlive(this),this._mode="3d",this},t.setProjectionMatrix=function(e){return MoGL.isAlive(this),this},t.setRenderArea=function(e,t,r,i){MoGL.isAlive(this);var n,a;return this._updateRenderArea=1,n=this._cvs.width,a=this._cvs.height,console.log("string"==typeof e?n*e.replace("%",""):e),this._renderArea=["string"==typeof e?n*e.replace("%","")*.01:e,"string"==typeof t?a*t.replace("%","")*.01:t,"string"==typeof r?n*r.replace("%","")*.01:r,"string"==typeof i?a*i.replace("%","")*.01:i],this},t.setAntialias=function(e){return MoGL.isAlive(this),this._antialias=e,this},t.setVisible=function(e){return MoGL.isAlive(this),this._visible=e,this},t.setFilter=function(e){MoGL.isAlive(this);var t;if(arguments[1])t=arguments[1];else switch(e){case Filter.anaglyph:t={offsetL:.008,offsetR:.008,gIntensity:.7,bIntensity:.7};break;case Filter.bevel:t={distance:4,angle:45,highlightColor:"#FFF",highlightAlpha:1,shadowColor:"#000",shadowAlpha:1,blurX:4,blurY:4,strength:1,quality:1,type:"inner",knockout:!1};break;case Filter.bloom:t={threshold:.3,sourceSaturation:1,bloomSaturation:1.3,sourceIntensity:1,bloomIntensity:1};break;case Filter.blur:t={blurX:4,blurY:4,quality:1};break;case Filter.colorMatrix:t={};break;case Filter.convolution:t={matrixX:0,matrixY:0,matrix:null,divisor:1,bias:0,preserveAlpha:!0,clamp:!0,color:0,alpha:0};break;case Filter.displacementMap:t={mapTextureID:null,mapPoint:null,componentX:0,componentY:0,scaleX:0,scaleY:0,mode:"wrap",color:0,alpha:0};break;case Filter.fxaa:t={};break;case Filter.glow:t={color:"#F00",alpha:1,blurX:6,blurY:6,strength:2,quality:1,inner:!1,knockout:!1};break;case Filter.invert:t={};break;case Filter.mono:t={};break;case Filter.sepia:t={};break;case Filter.shadow:t={distance:4,angle:45,color:0,alpha:1,blurX:4,blurY:4,strength:1,quality:1,inner:!1,knockout:!1,hideObject:!1}}return this._filters[e]=t,this},t.removeFilter=function(e){return MoGL.isAlive(this),delete this._filters[e],this},MoGL.ext(e,Mesh)}(),Scene=function(){var e,t;e=function(){this._update=0,this._cvs=null,this._children={},this._cameras={},this._textures={},this._materials={},this._geometrys={},this._vertexShaders={},this._fragmentShaders={},this._gl=null,this._glVBOs={},this._glVNBOs={},this._glUVBOs={},this._glIBOs={},this._glPROGRAMs={},this._glTEXTUREs={},this._glFREAMBUFFERs={};var e={attributes:["vec3 aVertexPosition"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uRotate","vec3 uScale","vec3 uPosition","vec3 uColor"],varyings:["vec3 vColor"],"function":[VertexShader.baseFunction],main:["gl_Position = uPixelMatrix*uCameraMatrix*positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale)*vec4(aVertexPosition, 1.0);\nvColor = uColor ;gl_PointSize = 10.0;"]},t={precision:"mediump float",uniforms:[],varyings:["vec3 vColor"],"function":[],main:["gl_FragColor =  vec4(vColor, 1.0)"]},r={attributes:["vec3 aVertexPosition","vec2 aUV"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uRotate","vec3 uScale","vec3 uPosition"],varyings:["vec2 vUV"],"function":[VertexShader.baseFunction],main:["gl_Position = uPixelMatrix*uCameraMatrix*positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale)*vec4(aVertexPosition, 1.0);\nvUV = aUV;"]},i={precision:"mediump float",uniforms:["sampler2D uSampler"],varyings:["vec2 vUV"],"function":[],main:["gl_FragColor =  texture2D(uSampler, vec2(vUV.s, vUV.t))"]},n={attributes:["vec3 aVertexPosition","vec2 aUV","vec3 aVertexNormal"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uDLite","float uLambert","vec3 uRotate","vec3 uScale","vec3 uPosition"],varyings:["vec2 vUV","vec4 vLight"],"function":[VertexShader.baseFunction],main:[" mat4 mv = positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale);\n gl_Position = uPixelMatrix*uCameraMatrix*mv*vec4(aVertexPosition, 1.0);\n vec3 LD = normalize(uDLite);\n vec3 N = normalize(vec3(mv * vec4(aVertexNormal, 0.0) ));\n vLight = vec4 (vec3(clamp(dot(N,-LD)*uLambert,0.05,1.0)),1.0);\n vUV = aUV;"]},a={precision:"mediump float",uniforms:["sampler2D uSampler"],varyings:["vec2 vUV","vec4 vLight"],"function":[],main:["gl_FragColor =  (vLight*texture2D(uSampler, vec2(vUV.s, vUV.t)));\ngl_FragColor.a = 1.0;"]},s={attributes:["vec3 aVertexPosition","vec2 aUV","vec3 aVertexNormal"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uDLite","float uLambert","vec3 uRotate","vec3 uScale","vec3 uPosition","vec3 uColor"],varyings:["vec3 vColor","vec4 vLight"],"function":[VertexShader.baseFunction],main:[" mat4 mv = positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale);\n gl_Position = uPixelMatrix*uCameraMatrix*mv*vec4(aVertexPosition, 1.0);\n vec3 LD = normalize(uDLite);\n vec3 N = normalize(vec3(mv * vec4(aVertexNormal, 0.0) ));\n vLight = vec4 (vec3(clamp(dot(N,-LD)*uLambert,0.05,1.0)),1.0);\n vColor = uColor;"]},o={precision:"mediump float",uniforms:["sampler2D uSampler"],varyings:["vec3 vColor","vec4 vLight"],"function":[],main:["gl_FragColor =  vLight*vec4(vColor,1.0);\ngl_FragColor.a = 1.0;"]},l={attributes:["vec3 aVertexPosition","vec2 aUV","vec3 aVertexNormal"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uRotate","vec3 uScale","vec3 uPosition","vec3 uColor"],varyings:["vec3 vNormal","vec3 vPosition","vec3 vColor"],"function":[VertexShader.baseFunction],main:["mat4 mv = positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale);\ngl_Position = uPixelMatrix*uCameraMatrix*mv*vec4(aVertexPosition, 1.0);\nvPosition = vec3(mv * vec4(aVertexPosition, 1.0));\nvNormal = vec3(mv * vec4(aVertexNormal, 0.0));\nvColor = uColor;"]},h={precision:"mediump float",uniforms:["float uLambert","vec3 uDLite"],varyings:["vec3 vNormal","vec3 vPosition","vec3 vColor"],"function":[],main:["vec3 ambientColor = vec3(0.0, 0.0, 0.0);\nvec3 diffuseColor = vec3(1.0, 1.0, 1.0);\nvec3 specColor = vec3(1.0, 1.0, 1.0);\nvec3 normal = normalize(vNormal);\nvec3 lightDir = normalize(-uDLite);\nvec3 reflectDir = reflect(lightDir, normal);\nvec3 viewDir = normalize(-vPosition);\nfloat lambertian = max(dot(lightDir,normal), 0.05)*uLambert;\nfloat specular = 0.0;\nif(lambertian > 0.0) {\nfloat specAngle = max(dot(reflectDir, viewDir), 0.0);\n   specular = pow(specAngle, 4.0);\n}\ngl_FragColor = vec4(vColor,1.0)*vec4(ambientColor +lambertian*diffuseColor +specular*specColor, 1.0);\ngl_FragColor.a = 1.0;"]},u={attributes:["vec3 aVertexPosition","vec2 aUV","vec3 aVertexNormal"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uRotate","vec3 uScale","vec3 uPosition","vec3 uColor"],varyings:["vec3 vNormal","vec3 vPosition","vec3 vColor"],"function":[VertexShader.baseFunction],main:["mat4 mv = positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale);\ngl_Position = uPixelMatrix*uCameraMatrix*mv*vec4(aVertexPosition, 1.0);\nvPosition = vec3(mv * vec4(aVertexPosition, 1.0));\nvNormal = vec3(mv * vec4(aVertexNormal, 0.0));\nvColor = uColor;"]},c={precision:"mediump float",uniforms:["float uLambert","vec3 uDLite"],varyings:["vec3 vNormal","vec3 vPosition","vec3 vColor"],"function":[],main:["vec3 ambientColor = vec3(0.0, 0.0, 0.0);\nvec3 diffuseColor = vec3(1.0, 1.0, 1.0);\nvec3 specColor = vec3(1.0, 1.0, 1.0);\nvec3 normal = normalize(vNormal);\nvec3 lightDir = normalize(-uDLite);\nvec3 reflectDir = reflect(lightDir, normal);\nvec3 viewDir = normalize(-vPosition);\nfloat lambertian = max(dot(lightDir,normal), 0.0)*uLambert;\nfloat specular = 0.0;\nvec3 src = vColor;\n if(lambertian>0.95) src.rgb*=0.95;\n else if(lambertian>0.6) src.rgb*=0.5;\n else if(lambertian>0.3) src.rgb*=0.3;\n else src.rgb*=0.1;\nif(lambertian > 0.0) {\nfloat specAngle = max(dot(reflectDir, viewDir), 0.0);\n   specular = pow(specAngle, 4.0);\n}\ngl_FragColor = vec4(src,1.0)*vec4(ambientColor +lambertian*diffuseColor +specular*specColor, 1.0);\ngl_FragColor.a = 1.0;"]},_={attributes:["vec3 aVertexPosition","vec2 aUV","vec3 aVertexNormal"],uniforms:["mat4 uPixelMatrix","mat4 uCameraMatrix","vec3 uRotate","vec3 uScale","vec3 uPosition"],varyings:["vec2 vUV","vec3 vNormal","vec3 vPosition"],"function":[VertexShader.baseFunction],main:["mat4 mv = positionMTX(uPosition)*rotationMTX(uRotate)*scaleMTX(uScale);\ngl_Position = uPixelMatrix*uCameraMatrix*mv*vec4(aVertexPosition, 1.0);\nvPosition = vec3(mv * vec4(aVertexPosition, 1.0));\nvNormal = vec3(mv * vec4(aVertexNormal, 0.0));\nvUV = aUV;"]
},m={precision:"mediump float",uniforms:["sampler2D uSampler","float uLambert","vec3 uDLite"],varyings:["vec2 vUV","vec3 vNormal","vec3 vPosition"],"function":[],main:["vec3 ambientColor = vec3(0.0, 0.0, 0.0);\nvec3 diffuseColor = vec3(1.0, 1.0, 1.0);\nvec3 specColor = vec3(1.0, 1.0, 1.0);\nvec3 normal = normalize(vNormal);\nvec3 lightDir = normalize(-uDLite);\nvec3 reflectDir = reflect(lightDir, normal);\nvec3 viewDir = normalize(-vPosition);\nfloat lambertian = max(dot(lightDir,normal), 0.05)*uLambert;\nfloat specular = 0.0;\nif(lambertian > 0.0) {\nfloat specAngle = max(dot(reflectDir, viewDir), 0.0);\n   specular = pow(specAngle, 4.0);\n}\ngl_FragColor = texture2D(uSampler, vec2(vUV.s, vUV.t))*vec4(ambientColor +lambertian*diffuseColor +specular*specColor, 1.0);\ngl_FragColor.a = 1.0;"]};this.addVertexShader("color",e),this.addFragmentShader("color",t),this.addVertexShader("bitmap",r),this.addFragmentShader("bitmap",i),this.addVertexShader("bitmapGouraud",n),this.addFragmentShader("bitmapGouraud",a),this.addVertexShader("colorGouraud",s),this.addFragmentShader("colorGouraud",o),this.addVertexShader("colorPhong",l),this.addFragmentShader("colorPhong",h),this.addVertexShader("colorToon",u),this.addFragmentShader("colorToon",c),this.addVertexShader("bitmapPhong",_),this.addFragmentShader("bitmapPhong",m)};var r=function(e,t,r,i){var n,a;return n=e._gl,(a=e._glVBOs[t])?a:(a=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,a),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),a.name=t,a.type="VBO",a.data=r,a.stride=i,a.numItem=r.length/i,e._glVBOs[t]=a,console.log("VBO생성",e._glVBOs[t]),e._glVBOs[t])},i=function(e,t,r,i){var n,a;return n=e._gl,(a=e._glVNBOs[t])?a:(a=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,a),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),a.name=t,a.type="VNBO",a.data=r,a.stride=i,a.numItem=r.length/i,e._glVNBOs[t]=a,console.log("VNBO생성",e._glVNBOs[t]),e._glVNBOs[t])},n=function(e,t,r,i){var n,a;return n=e._gl,(a=e._glIBOs[t])?a:(a=n.createBuffer(),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(r),n.STATIC_DRAW),a.name=t,a.type="IBO",a.data=r,a.stride=i,a.numItem=r.length/i,e._glIBOs[t]=a,console.log("IBO생성",e._glIBOs[t]),e._glIBOs[t])},a=function(e,t,r,i){var n,a;return n=e._gl,(a=e._glUVBOs[t])?a:(a=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,a),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),a.name=t,a.type="UVBO",a.data=r,a.stride=i,a.numItem=r.length/i,e._glUVBOs[t]=a,console.log("UVBO생성",e._glUVBOs[t]),e._glUVBOs[t])},s=function(e,t){var r,i,n,a,s;for(r=e._gl,i=o(e,e._vertexShaders[t]),n=l(e,e._fragmentShaders[t]),a=r.createProgram(),r.attachShader(a,i),r.attachShader(a,n),r.linkProgram(a),i.name=t+"_vertex",n.name=t+"_fragment",a.name=t,r.getProgramParameter(a,r.LINK_STATUS)||MoGL.error(t," 프로그램 쉐이더 초기화 실패!",0),r.useProgram(a),s=0;s<i.attributes.length;s++)r.bindBuffer(r.ARRAY_BUFFER,e._glVBOs["null"]),r.enableVertexAttribArray(a[i.attributes[s]]=r.getAttribLocation(a,i.attributes[s])),r.vertexAttribPointer(a[i.attributes[s]],e._glVBOs["null"].stride,r.FLOAT,!1,0,0);for(s=0;s<i.uniforms.length;s++)a[i.uniforms[s]]=r.getUniformLocation(a,i.uniforms[s]);for(s=0;s<n.uniforms.length;s++)a[n.uniforms[s]]=r.getUniformLocation(a,n.uniforms[s]);return e._glPROGRAMs[t]=a,a},o=function(e,t){var r,i,n,a,s,o;for(r=e._gl,o=r.createShader(r.VERTEX_SHADER),o.uniforms=[],o.attributes=[],s="",i=t.attributes,n=i.length,a=0;n>a;a++)s+="attribute "+i[a]+";\n",o.attributes.push(i[a].split(" ")[1]);for(i=t.uniforms,n=i.length,a=0;n>a;a++)s+="uniform "+i[a]+";\n",o.uniforms.push(i[a].split(" ")[1]);for(i=t.varyings,n=i.length,a=0;n>a;a++)s+="varying "+i[a]+";\n";return s+=VertexShader.baseFunction,s+="void main(void){\n",s+=t.main+";\n",s+="}\n",r.shaderSource(o,s),r.compileShader(o),o},l=function(e,t){var r,i,n,a,s,o;for(r=e._gl,i="",o=r.createShader(r.FRAGMENT_SHADER),o.uniforms=[],i+=t.precision?"precision "+t.precision+";\n":"precision mediump float;\n",a=t.uniforms,s=a.length,n=0;s>n;n++)i+="uniform "+a[n]+";\n",o.uniforms.push(a[n].split(" ")[1]);for(a=t.varyings,s=a.length,n=0;s>n;n++)i+="varying "+a[n]+";\n";return i+="void main(void){\n",i+=t.main+";\n",i+="}\n",r.shaderSource(o,i),r.compileShader(o),o},h=function(e,t,r){var i,n;return i=e._gl,(n=e._glTEXTUREs[t])?n:(n=i.createTexture(),n.img=new Image,console.log(typeof r,r),r instanceof ImageData?n.img.src=r.data:r instanceof HTMLCanvasElement?n.img.src=r.toDataURL():r instanceof HTMLImageElement?n.img.src=r.src:r.substring&&"data:image"==r.substring(0,10)&&r.indexOf("base64")>-1?n.img.src=r:"string"==typeof r&&(n.img.src=r),n.img.onload=function(){var e=function(e){return 0==(e&e-1)};i.bindTexture(i.TEXTURE_2D,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n.img),e(n.img.width)&&e(n.img.height)?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.generateMipmap(i.TEXTURE_2D)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR)),n.loaded=1},n.data=r,e._glTEXTUREs[t]=n,i.bindTexture(i.TEXTURE_2D,null),n)},u=function(e,t){var r,i,n,a;r=e._gl,i=r.createFramebuffer(),r.bindFramebuffer(r.FRAMEBUFFER,i),i.x=t._renderArea[0],i.y=t._renderArea[1],i.width=t._renderArea[2],i.height=t._renderArea[3],n=r.createTexture(),r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i.width,i.height,0,r.RGBA,r.UNSIGNED_BYTE,null),a=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,a),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,i.width,i.height),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,a),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,null),e._glFREAMBUFFERs[t.uuid]={frameBuffer:i,texture:n}};return t=e.prototype,t.update=function(){MoGL.isAlive(this);var e,t;this._glVBOs["null"]=r(this,"null",new Float32Array([0,0,0]),3);for(e in this._children){var o,l=this._children[e],h=l._geometry;h&&(this._geometrys[h._key]||this.addGeometry(h._key,h),this._glVBOs[h]||(o=h._key,this._glVBOs[o]=r(this,o,h._position,3),this._glVNBOs[o]=i(this,o,h._normal,3),this._glUVBOs[o]=a(this,o,h._uv,2),this._glIBOs[o]=n(this,o,h._index,1)))}this._glVBOs.rect||(this._glVBOs.rect=r(this,"rect",[-1,-1,0,1,-1,0,1,1,0,-1,1,0],3),this._glUVBOs.rect=a(this,"rect",[0,0,1,0,1,1,0,1],2),this._glIBOs.rect=n(this,"rect",[0,1,2,0,2,3],1));for(e in this._cameras){var c=this._cameras[e];c._cvs=this._cvs,c._renderArea||c.setRenderArea(0,0,this._cvs.width,this._cvs.height),c._updateRenderArea&&(c.getProjectionMatrix(),u(this,c),c._updateRenderArea=0)}t=this._vertexShaders;for(e in t)s(this,e);console.log("////////////////////////////////////////////"),console.log("Scene 업데이트"),console.log("this._glVBOs :",this._glVBOs),console.log("this._glVNBOs :",this._glVNBOs),console.log("this._glIBOs :",this._glIBOs),console.log("this._glPROGRAMs :",this._glPROGRAMs),console.log("this._geometrys :",this._geometrys),console.log("this._materials :",this._materials),console.log("this._textures :",this._textures),console.log("this._vertexShaders :",this._vertexShaders),console.log("this._fragmentShaders :",this._fragmentShaders),console.log("this._glFREAMBUFFERs :",this._glFREAMBUFFERs),console.log("////////////////////////////////////////////"),this._update=0},t.addChild=function(e,t){MoGL.isAlive(this);var r,i;this._children[e]&&MoGL.error("Scene","addChild",0),t instanceof Mesh||MoGL.error("Scene","addChild",1),t._scene=this,t._parent=this,t.setGeometry(t._geometry),t.setMaterial(t._material),t._material._count++,i=t._geometry._vertexShaders;for(r in i)"string"==typeof i[r]&&(this._vertexShaders[i[r]]||MoGL.error("Scene","addChild",2));i=t._material._fragmentShaders;for(r in i)"string"==typeof i[r]&&(this._fragmentShaders[i[r]]||MoGL.error("Scene","addChild",3));i=t._material._textures;for(r in i)"string"==typeof i[r]&&(this._textures[i[r]]?(console.log(t._material._textures),console.log(i[r]),t._material._textures[i[r]]=this._textures[i[r]]):MoGL.error("Scene","addChild",4));return t instanceof Camera?(this._cameras[e]=t,t._cvs=this._cvs):this._children[e]=t,this._update=1,this},t.addGeometry=function(e,t){MoGL.isAlive(this),this._geometrys[e]&&MoGL.error("Scene","addGeometry",0),t instanceof Geometry||MoGL.error("Scene","addGeometry",1);var r,i=t._vertexShaders;for(r in i)"string"==typeof i[r]&&(this._vertexShaders[i[r]]||MoGL.error("Scene","addGeometry",2));return this._geometrys[e]=t,this},t.addMaterial=function(e,t){MoGL.isAlive(this),this._materials[e]&&MoGL.error("Scene","addMaterial",0),t instanceof Material||MoGL.error("Scene","addMaterial",1);var r,i=t._fragmentShaders;for(r in i)"string"==typeof i[r]&&(this._fragmentShaders[i[r]]||MoGL.error("Scene","addMaterial",2));i=t._textures;for(r in i)"string"==typeof i[r]&&(this._textures[i[r]]||MoGL.error("Scene","addMaterial",3));return this._materials[e]=t,this._materials[e]._scene=this,this},t.addTexture=function(e,t){function r(e){return e instanceof HTMLImageElement?0:e instanceof HTMLCanvasElement?0:e instanceof HTMLVideoElement?0:e instanceof ImageData?0:e.substring&&"data:image"==e.substring(0,10)&&e.indexOf("base64")>-1?0:"string"==typeof e?0:1}return MoGL.isAlive(this),this._textures[e]&&MoGL.error("Scene","addTexture",0),r(t)&&MoGL.error("Scene","addTexture",1),this._textures[e]?this._textures[e].img=h(this,e,t):(this._textures[e]={count:0,last:0,img:null,resizeType:arguments[2]||null},this._textures[e].img=h(this,e,t),console.log(this._textures),console.log(e,t)),this},t.addFragmentShader=function(e,t){return MoGL.isAlive(this),this._fragmentShaders[e]&&MoGL.error("Scene","addFragmentShader",0),this._fragmentShaders[e]=t,this},t.addVertexShader=function(e,t){return MoGL.isAlive(this),this._vertexShaders[e]&&MoGL.error("Scene","addVertexShader",0),this._vertexShaders[e]=t,this},t.getChild=function(e){MoGL.isAlive(this);var t=this._children[e];return t=t?t:this._cameras[e],t?t:null},t.getGeometry=function(e){MoGL.isAlive(this);var t=this._geometrys[e];return t?t:null},t.getMaterial=function(e){MoGL.isAlive(this);var t=this._materials[e];return t?t:null},t.getTexture=function(e){MoGL.isAlive(this);var t=this._textures[e];return t?t:null},t.getFragmentShader=function(e){return MoGL.isAlive(this),this._fragmentShaders[e]},t.getVertexShader=function(e){return MoGL.isAlive(this),this._vertexShaders[e]},t.removeChild=function(e){return MoGL.isAlive(this),this._children[e]?(this._children[e]._material._count--,this._children[e]._scene=null,this._children[e]._parent=null,delete this._children[e],!0):!1},t.removeGeometry=function(e){return MoGL.isAlive(this),this._geometrys[e]?(delete this._geometrys[e],!0):!1},t.removeMaterial=function(e){return MoGL.isAlive(this),this._materials[e]?(delete this._materials[e],!0):!1},t.removeTexture=function(e){return MoGL.isAlive(this),this._textures[e]?(delete this._textures[e],!0):!1},t.removeFragmentShader=function(){return MoGL.isAlive(this),this},t.removeVertexShader=function(){return MoGL.isAlive(this),this},MoGL.ext(e,MoGL)}(),World=function(){var e,t,r=Matrix.create(),i=new Float32Array(3);return e=function(e){var t,r,i;e||MoGL.error("World","constructor",0),this._cvs=document.getElementById(e),this._cvs||MoGL.error("World","constructor",1);var n=window.innerWidth,a=window.innerHeight;for(this._pixelRatio=window.devicePixelRatio,this._cvs.width=n*this._pixelRatio,this._cvs.height=a*this._pixelRatio,this._cvs.style.width=n+"px",this._cvs.style.height=a+"px",this._renderList=[],this._sceneList={},this.LOOP={},t="experimental-webgl,webgl,webkit-3d,moz-webgl,3d".split(","),r=t.length;r--&&!(this._gl=this._cvs.getContext(t[r],{antialias:!0})););i=this._gl.getExtension("OES_element_index_uint"),i||alert("no! OES_element_index_uint"),console.log(this._gl?e+" : MoGL 초기화 성공!":console.log(e+" : MoGL 초기화 실패!!"))},t=e.prototype,t.render=function(){MoGL.isAlive(this);var e,t,n,a,s,o,l,h,u,c,_,m,v,d,g,f,M,x,p,A,L,R,b=this._renderList;for(t in this.LOOP)this.LOOP[t]();for(e=0,n=b.length;n>e;e++)if(b[e].scene._update&&b[e].scene.update(),a=b[e].scene,s=a.getChild(b[e].cameraID),s._visible){o=a._gl,n>1?(g=a._glFREAMBUFFERs[s.uuid].frameBuffer,o.bindFramebuffer(o.FRAMEBUFFER,g),o.viewport(0,0,g.width,g.height)):o.viewport(0,0,this._cvs.width,this._cvs.height),l=a._children,o.clearColor(s._r,s._g,s._b,s._a),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.enable(o.DEPTH_TEST),o.depthFunc(o.LESS);for(t in a._glPROGRAMs)c=a._glPROGRAMs[t],o.useProgram(c),o.uniformMatrix4fv(c.uPixelMatrix,!1,s._pixelMatrix),o.uniformMatrix4fv(c.uCameraMatrix,!1,s.getMatrix());h=u=c=_=d=null;for(t in l){h=l[t],_=a._glVBOs[h._geometry._key],m=a._glVNBOs[h._geometry._key],v=a._glUVBOs[h._geometry._key],d=a._glIBOs[h._geometry._key],u=h._material,f=u._diffuse;var y=[0,1,1],E=0;if(0==f.__indexList.length)"none"==u._shading.type?(c=a._glPROGRAMs.color,o.useProgram(c)):"toon"==u._shading.type?(c=a._glPROGRAMs.colorToon,o.useProgram(c),E=1):"gouraud"==u._shading.type?(c=a._glPROGRAMs.colorGouraud,o.useProgram(c),E=1):"phong"==u._shading.type&&(c=a._glPROGRAMs.colorPhong,o.useProgram(c),E=1),R!=c&&(R=null,M=null,x=null,p=null,A=null,L=null),E&&(m!=x?o.bindBuffer(o.ARRAY_BUFFER,m):0,m!=x?o.vertexAttribPointer(c.aVertexNormal,m.stride,o.FLOAT,!1,0,0):0,o.uniform3fv(c.uDLite,y),o.uniform1f(c.uLambert,u._shading.lambert)),_!=M?o.bindBuffer(o.ARRAY_BUFFER,_):0,_!=M?o.vertexAttribPointer(c.aVertexPosition,_.stride,o.FLOAT,!1,0,0):0,i[0]=u._r,i[1]=u._g,i[2]=u._b,o.uniform3fv(c.uColor,i);else{"none"==u._shading.type?(c=a._glPROGRAMs.bitmap,o.useProgram(c)):"flat"==u._shading.type||("gouraud"==u._shading.type?(c=a._glPROGRAMs.bitmapGouraud,o.useProgram(c),E=1):"phong"==u._shading.type?(c=a._glPROGRAMs.bitmapPhong,o.useProgram(c),E=1):"blinn"==u._shading.type),R!=c&&(R=null,M=null,x=null,p=null,A=null,L=null),E&&(m!=x?o.bindBuffer(o.ARRAY_BUFFER,m):0,m!=x?o.vertexAttribPointer(c.aVertexNormal,m.stride,o.FLOAT,!1,0,0):0,o.uniform3fv(c.uDLite,y),o.uniform1f(c.uLambert,u._shading.lambert)),_!=M?o.bindBuffer(o.ARRAY_BUFFER,_):0,_!=M?o.vertexAttribPointer(c.aVertexPosition,_.stride,o.FLOAT,!1,0,0):0,v!=p?o.bindBuffer(o.ARRAY_BUFFER,v):0,v!=p?o.vertexAttribPointer(c.aUV,v.stride,o.FLOAT,!1,0,0):0,o.activeTexture(o.TEXTURE0);var G=a._glTEXTUREs[f.__indexList[0].id];G.loaded&&(G!=L?o.bindTexture(o.TEXTURE_2D,G):0,o.uniform1i(c.uSampler,0))}i[0]=h.rotateX,i[1]=h.rotateY,i[2]=h.rotateZ,o.uniform3fv(c.uRotate,i),i[0]=-h.x,i[1]=-h.y,i[2]=h.z,o.uniform3fv(c.uPosition,i),i[0]=h.scaleX,i[1]=h.scaleY,i[2]=h.scaleZ,o.uniform3fv(c.uScale,i),d!=A?o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,d):0,u._wireFrame?(c=a._glPROGRAMs.color,o.useProgram(c),_!=M?o.bindBuffer(o.ARRAY_BUFFER,_):0,_!=M?o.vertexAttribPointer(c.aVertexPosition,_.stride,o.FLOAT,!1,0,0):0,i[0]=h.rotateX,i[1]=h.rotateY,i[2]=h.rotateZ,o.uniform3fv(c.uRotate,i),i[0]=-h.x,i[1]=-h.y,i[2]=h.z,o.uniform3fv(c.uPosition,i),i[0]=h.scaleX,i[1]=h.scaleY,i[2]=h.scaleZ,o.uniform3fv(c.uScale,i),i[0]=u._rw,i[1]=u._gw,i[2]=u._bw,o.uniform3fv(c.uColor,i),o.drawElements(o.LINES,d.numItem,o.UNSIGNED_SHORT,0)):o.drawElements(o.TRIANGLES,d.numItem,o.UNSIGNED_SHORT,0),R=c,M=_,x=E?m:null,p=v,A=d,L=G}o.bindFramebuffer(o.FRAMEBUFFER,null)}if(n>1){if(o.viewport(0,0,this._cvs.clientWidth,this._cvs.clientHeight),o.clearColor(0,0,0,1),o.disable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),_=a._glVBOs.rect,v=a._glUVBOs.rect,d=a._glIBOs.rect,c=a._glPROGRAMs.bitmap,!_)return;for(o.useProgram(c),o.uniformMatrix4fv(c.uPixelMatrix,!1,[2/this._cvs.clientWidth,0,0,0,0,-2/this._cvs.clientHeight,0,0,0,0,0,0,-1,1,0,1]),o.bindBuffer(o.ARRAY_BUFFER,_),o.vertexAttribPointer(c.aVertexPosition,_.stride,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,v),o.vertexAttribPointer(c.aUV,v.stride,o.FLOAT,!1,0,0),o.uniform3fv(c.uRotate,[0,0,0]),o.uniformMatrix4fv(c.uCameraMatrix,!1,r),e=0,n=b.length;n>e;e++)a=b[e].scene,s=a.getChild(b[e].cameraID),s._visible&&(g=a._glFREAMBUFFERs[s.uuid].frameBuffer,i[0]=g.x+g.width/2,i[1]=g.y+g.height/2,i[2]=0,o.uniform3fv(c.uPosition,i),i[0]=g.width/2,i[1]=g.height/2,i[2]=1,o.uniform3fv(c.uScale,i),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a._glFREAMBUFFERs[s.uuid].texture),o.uniform1i(c.uSampler,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,d),o.drawElements(o.TRIANGLES,d.numItem,o.UNSIGNED_SHORT,0))}},t.addRender=function(e,t,r){MoGL.isAlive(this);var i,n,a,s,o,l;for(i=e+"_"+t,n=this._sceneList[e],a=this._renderList,s=0,o=a.length;o>s;s++)a[s].uuid==i&&MoGL.error("World","addRender",0);return n?n.isAlive||MoGL.error("World","addRender",1):MoGL.error("World","addRender",1),n&&(n.getChild(t)?n.getChild(t).isAlive||MoGL.error("World","addRender",2):MoGL.error("World","addRender",2)),l={uuid:i,sceneID:e,cameraID:t,scene:n,camera:n.getChild(t)},n._update=1,r?a[r]=l:a.push(l),this},t.addScene=function(e,t){return MoGL.isAlive(this),this._sceneList[e]&&MoGL.error("World","addScene",0),t instanceof Scene||MoGL.error("World","addScene",1),this._sceneList[e]=t,t._gl=this._gl,t._cvs=this._cvs,this},t.getScene=function(e){return MoGL.isAlive(this),"undefined"==typeof e&&MoGL.error("World","getScene",0),this._sceneList[e]?this._sceneList[e]:null},t.removeRender=function(e,t){MoGL.isAlive(this);var r,i,n=this._renderList,a=0,s=0;for(this._sceneList[e]||MoGL.error("World","removeRender",0),this._sceneList[e]._cameras[t]||(console.log("2222222222222222222222222"),MoGL.error("World","removeRender",1)),r=0,i=n.length;i>r;r++)n[r].uuid.indexOf(e)>-1&&(a=1),n[r].uuid.indexOf(t)>-1&&(s=1);for(a||MoGL.error("World","removeRender",2),s||MoGL.error("World","removeRender",3),r=0,i=n.length;i>r;r++)n[r]&&n[r].uuid==e+"_"+t&&n.splice(r,1);return this},t.removeScene=function(e){return MoGL.isAlive(this),this._sceneList[e]?0:MoGL.error("World","removeScene",0),this._sceneList[e]._gl=this._gl,delete this._sceneList[e],this},MoGL.ext(e,MoGL)}();